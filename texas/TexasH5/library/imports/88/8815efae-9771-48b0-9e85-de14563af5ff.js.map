{"version":3,"sources":["assets\\Script\\BaseFrame\\StatusbarView.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA,uCAAkC;AAElC,WAAW;AACX;IAA2C,iCAAQ;IAAnD;QAAA,qEAqFC;QA3EW,aAAO,GAAoB,IAAI,CAAC;QACxC,QAAQ;QACA,gBAAU,GAAsB,IAAI,CAAC;QAC7C,UAAU;QACF,sBAAgB,GAAoB,IAAI,CAAC;QACjD,QAAQ;QACA,wBAAkB,GAAoB,IAAI,CAAC;;IAqEvD,CAAC;IApFG,sBAAc,8CAAmB;aAAjC;YACI,OAAO,YAAY,CAAC;QACxB,CAAC;;;OAAA;IACD,sBAAc,sCAAW;aAAzB;YACI,OAAO,QAAQ,CAAC;QACpB,CAAC;;;OAAA;IACD,sBAAc,wCAAa;aAA3B;YACI,OAAO,WAAW,CAAC;QACvB,CAAC;;;OAAA;IASD,6CAAqB,GAArB;QAAA,iBAYC;QAXG,iBAAM,qBAAqB,WAAE,CAAC;QAC9B,IAAI,CAAC,aAAa,CAAC,YAAY,GAAG,IAAI,CAAC;QACvC,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;QACnE,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;QACvE,IAAI,CAAC,QAAQ,CAAC;YACV,KAAI,CAAC,gBAAgB,EAAE,CAAC;YACxB,IAAI,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;YACtB,IAAI,IAAI,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YAC3B,IAAI,OAAO,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC;YAChC,KAAI,CAAC,OAAO,CAAC,IAAI,GAAM,IAAI,UAAI,OAAO,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,GAAG,OAAO,CAAC,CAAC,CAAC,OAAO,CAAE,CAAC;QAC5E,CAAC,EAAE,CAAC,CAAC,CAAC;IACV,CAAC;IAEM,wCAAgB,GAAvB;QACI,IAAI,OAAO,GAAW,EAAE,CAAC;QACzB,IAAI,GAAG,GAAW,EAAE,CAAC;QACrB,IAAI,EAAE,CAAC,GAAG,CAAC,QAAQ,IAAI,EAAE,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,CAAC,GAAG,CAAC,UAAU,EAAE;YACnD,cAAc;YACd,IAAI,MAAM,GAAG,sBAAsB,CAAC;YACpC,IAAI,eAAe,GAAG,sBAAsB,CAAC;YAC7C,OAAO,GAAG,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,sCAAsC,EAAE,MAAM,EAAE,eAAe,CAAC,CAAC;YAE3G,YAAY;YACZ,IAAI,OAAO,GAAG,gBAAgB,CAAC;YAC/B,GAAG,GAAG,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,sCAAsC,EAAE,OAAO,EAAE,eAAe,CAAC,CAAC;SAC3G;aAAM,IAAI,EAAE,CAAC,GAAG,CAAC,QAAQ,IAAI,EAAE,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,CAAC,GAAG,CAAC,MAAM,EAAE;YACtD,+BAA+B;YAC/B,8DAA8D;YAC9D,iEAAiE;YACjE,0DAA0D;YAC1D,0BAA0B;YAC1B,OAAO,GAAG,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,iBAAiB,EAAE,cAAc,CAAC,CAAC;YAC7E,aAAa;YACb,2CAA2C;YAC3C,yDAAyD;YACzD,GAAG,GAAG,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,iBAAiB,EAAE,gBAAgB,CAAC,CAAC;SAC9E;QACD,IAAI,OAAO,EAAE;YACT,IAAI,UAAU,GAAG,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACpC,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;SAC1C;QAED,IAAI,GAAG,EAAE;YACL,IAAI,MAAM,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAC5B,IAAI,MAAM,CAAC,CAAC,CAAC,IAAI,GAAG,EAAE,EAAE,MAAM;gBAC1B,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;gBAC1C,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;aAC/C;iBAAM,IAAI,MAAM,CAAC,CAAC,CAAC,IAAI,GAAG,EAAE,EAAE,MAAM;gBACjC,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;gBAC1C,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;aACxD;SACJ;IACL,CAAC;IAID,iCAAS,GAAT;QACI,IAAI,CAAC,sBAAsB,EAAE,CAAC;IAClC,CAAC;IACD,iCAAS,GAAT;QACI,IAAI,CAAC,sBAAsB,EAAE,CAAC;IAClC,CAAC;IAED,uCAAe,GAAf;QACI,IAAI,CAAC,IAAI,EAAE,CAAC;IAChB,CAAC;IACL,oBAAC;AAAD,CArFA,AAqFC,CArF0C,kBAAQ,GAqFlD","file":"","sourceRoot":"/","sourcesContent":["import ViewBase from \"./ViewBase\";\r\n\r\n/**状态栏信息 */\r\nexport default class StatusbarView extends ViewBase {\r\n    protected get packageResourceName(): string {\r\n        return \"GameCommon\";\r\n    }\r\n    protected get packageName(): string {\r\n        return \"Common\";\r\n    }\r\n    protected get componentName(): string {\r\n        return \"statusbar\";\r\n    }\r\n    private ui_time: fgui.GTextField = null;\r\n    /**电量 */\r\n    private ui_battery: fgui.GProgressBar = null;\r\n    /**信号显示 */\r\n    private signalController: fgui.Controller = null;\r\n    /**强度 */\r\n    private strengthController: fgui.Controller = null;\r\n\r\n    createChildComponents() {\r\n        super.createChildComponents();\r\n        this.fguiComponent.sortingOrder = 9999;\r\n        this.signalController = this.fguiComponent.getController(\"signal\");\r\n        this.strengthController = this.fguiComponent.getController(\"strength\");\r\n        this.schedule(() => {\r\n            this.callNativeMethod();\r\n            let date = new Date();\r\n            let hous = date.getHours();\r\n            let minutes = date.getMinutes();\r\n            this.ui_time.text = `${hous}:${minutes < 10 ? \"0\" + minutes : minutes}`;\r\n        }, 1);\r\n    }\r\n\r\n    public callNativeMethod() {\r\n        let battery: string = \"\";\r\n        let net: string = \"\";\r\n        if (cc.sys.isNative && cc.sys.os == cc.sys.OS_ANDROID) {\r\n            /**获取电池电量信息 */\r\n            let method = \"getBatteryStatusInfo\";\r\n            let methodSignature = \"()Ljava/lang/String;\";\r\n            battery = jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/TSJavaBridge\", method, methodSignature);\r\n\r\n            /**获取网络状态 */\r\n            let method1 = \"getNetWorkInfo\";\r\n            net = jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/TSJavaBridge\", method1, methodSignature);\r\n        } else if (cc.sys.isNative && cc.sys.os == cc.sys.OS_IOS) {\r\n            // UIDeviceBatteryStateUnknown,\r\n            // UIDeviceBatteryStateUnplugged,   // on battery, discharging\r\n            // UIDeviceBatteryStateCharging,    // plugged in, less than 100%\r\n            // UIDeviceBatteryStateFull,        // plugged in, at 100%\r\n            // 10_100_2  当前电量_总电量_电池状态\r\n            battery = jsb.reflection.callStaticMethod(\"TSObjectCBridge\", \"GetBatteryLv\");\r\n            // 返回值 示例：1_1\r\n            // 第一个值 网络类型 -1: 没有网络    1: 移动数据    2: WIFI\r\n            // 第二个值 网络信号 0: None  1:poor  2:moderate  3:good  4:great\r\n            net = jsb.reflection.callStaticMethod(\"TSObjectCBridge\", \"getNetworkType\");\r\n        }\r\n        if (battery) {\r\n            let batteryArr = battery.split(\"_\");\r\n            this.ui_battery.value = +batteryArr[0];\r\n        }\r\n\r\n        if (net) {\r\n            let netArr = net.split(\"_\");\r\n            if (netArr[0] == \"1\") { //移动网络\r\n                this.signalController.setSelectedIndex(0);\r\n                this.strengthController.setSelectedIndex(4);\r\n            } else if (netArr[0] == \"2\") { //wifi\r\n                this.signalController.setSelectedIndex(1);\r\n                this.strengthController.setSelectedIndex(+netArr[1]);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    onDisable() {\r\n        this.unscheduleAllCallbacks();\r\n    }\r\n    onDestroy() {\r\n        this.unscheduleAllCallbacks();\r\n    }\r\n\r\n    OnLoadCompleted() {\r\n        this.Show();\r\n    }\r\n}"]}