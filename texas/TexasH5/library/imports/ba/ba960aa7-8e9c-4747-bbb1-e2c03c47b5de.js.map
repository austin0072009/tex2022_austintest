{"version":3,"sources":["assets\\Script\\modules\\@slotsmaster\\ui-common\\lib\\LevelUp\\LevelUp.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["//import { fgui } from \"fairygui\";\nimport LevelUpSpine from \"./LevelUpSpine\";\n\n\nimport { Coin } from \"../Coin/Coin\";\n\nimport { Popup } from \"../Popup\";\nimport { Integral } from \"../Coin/Integral\";\n\nimport RippleSpine from \"../Ripple/RippleSpine\";\nimport { MogafaNumberField } from \"../../../../@mogafa/fairygui-component/lib/extensions/MogafaNumberField\";\nimport SoundMgr from \"../../../../@mogafa/utils/lib/SoundMgr\";\nimport { Utils } from \"../../../../@mogafa/utils/lib/Utils\";\nimport SpinResultsUpgrade from \"../../../../spin-result/SpinResultsUpgrade\";\n\nenum UpgradeMode {\n    Primary,\n    Advanced,\n    Small,\n}\nconst LEVEL_UP_AD: string = \"LEVEL_UP_AD\";\nexport class LevelUp extends Popup {\n    protected get basePanel(): string {\n        return \"\";\n    }\n    protected get animNode(): cc.Node[] {\n        throw new Error(\"Method not implemented.\");\n    }\n    protected get buttonOKName(): string {\n        return \"\";\n    }\n    protected get goldGrowName(): string[] {\n        throw new Error(\"Method not implemented.\");\n    }\n    protected get normalNumName(): string[] {\n        throw new Error(\"Method not implemented.\");\n    }\n    public get closeTime(): number {\n        return -1;\n    }\n    private _maskNode: cc.Node;\n    //* 升级spine\n    private _levelUpSpine: LevelUpSpine;\n    //* 大升级弹窗等级\n    private _levelLabel: fgui.GLabel;\n    //* 大升级弹框金币\n    private _coinLabel: fgui.GLabel;\n    //* 大升级弹框积分\n    private _integralLabel: fgui.GLabel;\n    //* 小升级弹窗等级\n    private _levelLabelTop: fgui.GLabel;\n    //* 小升级弹窗金币\n    private _coinLabelTop: fgui.GLabel;\n    //* 小升级弹窗积分\n    private _integralLabelTop: fgui.GLabel;\n    //* coin LltyuNumberField\n    private _coin: MogafaNumberField;\n    //* integral LltyuNumberField\n    private _integral: MogafaNumberField;\n    //* 收集按钮\n    private _collectButton: fgui.GButton;\n    //* 双击按钮\n    private _doubleButton: fgui.GButton;\n    //* 金币增长需要时间\n    private _coinIncreaseTime: number = 1.5;\n    //* 升级获取的金币奖励\n    private _rewardCoins: number;\n    //* 升级获取的积分奖励\n    private _rewardIntegral: number;\n    //* 飞行金币数\n    private _flyCoins: number = 100;\n    //* 飞行积分数\n    private _flyIntegrals: number = 20;\n    //* 金币动画结束坐标\n    private _coinEndPos: cc.Vec2;\n    //* 积分动画结束坐标\n    private _integralEndPos: cc.Vec2;\n    //* 金币是否可以飞行\n    private _isCoinFly: boolean;\n    //* 升级模式\n    private _upgradeMode: UpgradeMode;\n    //* 点击缓存\n    private _clickBuffer: number = 0;\n    //* 波纹节点\n    private _rippleNode: cc.Node;\n    //* 波纹spine\n    private _rippleSpine: RippleSpine;\n    public get coinEndPos(): cc.Vec2 {\n        return this._coinEndPos;\n    }\n    public set coinEndPos(value: cc.Vec2) {\n        this._coinEndPos = value;\n    }\n    public get integralEndPos(): cc.Vec2 {\n        return this._integralEndPos;\n    }\n    public set integralEndPos(value: cc.Vec2) {\n        this._integralEndPos = value;\n    }\n    protected get packageResourceName(): string {\n        return \"GameCommon\";\n    }\n    protected get packageName(): string {\n        return \"Common\";\n    }\n    protected get componentName(): string {\n        return \"LevelUp\";\n    }\n    private get isCoinFly(): boolean {\n        return this._isCoinFly;\n    }\n    private set isCoinFly(value: boolean) {\n        this._isCoinFly = value;\n        if (this._isCoinFly) {\n            //* 飞行时间，与每个金币飞行时间保持同步\n            let flyTime: number = 1;\n            this.scheduleOnce(() => {\n                this.awardIncreaseCallback(this._rewardCoins, this._rewardIntegral);\n            }, flyTime);\n        }\n    }\n    protected async createChildComponents() {\n        super.createChildComponents();\n        this.fguiComponent.makeFullScreen();\n        let spineNode = this.fguiComponent.getChild(\"levelUp\").node;\n        this._maskNode = this.getChild(\"mask\").node;\n        this._levelUpSpine = new LevelUpSpine(spineNode);\n        this.addChild(this._levelUpSpine);\n        //* 小升级弹框label\n        this._levelLabelTop = this.fguiComponent.getChild(\"levelLabelTop\").asLabel;\n        this._coinLabelTop = this.fguiComponent.getChild(\"coinLabelTop\").asLabel;\n        this._integralLabelTop = this.fguiComponent.getChild(\"integralLabelTop\").asLabel;\n        //* 大升级弹框label、image\n        this._levelLabel = this.fguiComponent.getChild(\"levelLabel\").asLabel;\n        this._coinLabel = this.fguiComponent.getChild(\"coinLabel\").asLabel;\n        this._integralLabel = this.fguiComponent.getChild(\"integralLabel\").asLabel;\n        this._coin = this.fguiComponent.getChild(\"coinLabel\").asMogafaNumberField();\n        this._integral = this.fguiComponent.getChild(\"integralLabel\").asMogafaNumberField();\n        //* 收集按钮\n        this._collectButton = this.fguiComponent.getChild(\"collectButton\").asButton;\n        this._collectButton.onClick(this.collectClick, this);\n        //* 双击按钮\n        this._doubleButton = this.fguiComponent.getChild(\"doubleButton\").asButton;\n        this._doubleButton.onClick(this.adButtonClick, this);\n\n        this.coinEndPos = cc.v2(this.getChild(\"coin\").node.position.x, this.getChild(\"coin\").node.position.y);\n        this.integralEndPos = cc.v2(this.getChild(\"integral\").node.position.x, this.getChild(\"integral\").node.position.y);\n        //* 加载波纹节点、spine\n        this._rippleNode = this.getChild(\"ripple\").node;\n        this._rippleNode.zIndex = 99;\n        this._rippleSpine = new RippleSpine(this._rippleNode);\n        this.addChild(this._rippleSpine);\n        //* 初始化隐藏所有label\n        this.hideLevelLabel();\n    }\n    private awardIncreaseCallback: Function;\n    /**\n     * 升级\n     * @param upgrade 升级数据\n     * @param awardIncreaseCallback 奖励数字增加回调\n     */\n    public upgrade(upgrade: SpinResultsUpgrade, awardIncreaseCallback: Function) {\n        this.resetFly();\n        this._rewardCoins = upgrade.award;\n        this._rewardIntegral = upgrade.points;\n        this._upgradeMode = this.getUpgradeMode(upgrade.level);\n        this.awardIncreaseCallback = awardIncreaseCallback;\n        this.show();\n        switch (this._upgradeMode) {\n            case UpgradeMode.Primary:\n                this._maskNode.active = true;\n                this._levelUpSpine.primary(upgrade.maxBet);\n                break;\n            case UpgradeMode.Advanced:\n                this._maskNode.active = true;\n                this._levelUpSpine.dvanced(upgrade.maxBet);\n                break;\n            case UpgradeMode.Small:\n                this.scheduleOnce(() => {\n                    this.isCoinFly = true;\n                    //* 金币飞行音效\n                    SoundMgr.getInstance().playEffect(\"frame_coins\");\n                }, 0.5);\n                this._levelUpSpine.small(upgrade.maxBet);\n                break;\n        }\n        this.scheduleOnce(() => {\n            this.showLevel(upgrade.level, upgrade.award, upgrade.points, this._upgradeMode);\n        }, 0.5);\n    }\n    private _closeCallback: Function;\n    public closeCallback(callback: Function): void {\n        this._closeCallback = callback;\n    }\n    /**\n     * 重置飞行参数\n     */\n    private resetFly(): void {\n        this._rewardCoins = 0;\n        this._rewardIntegral = 0;\n        this._flyCoins = 100;\n        this._flyIntegrals = 20;\n    }\n    /**\n     * 获取升级模式\n     * @param level\n     */\n    private getUpgradeMode(level: number): UpgradeMode {\n        if (level % 5 !== 0) {\n            return UpgradeMode.Small;\n        }\n        if (level % 10 == 0) {\n            return UpgradeMode.Advanced;\n        }\n        return UpgradeMode.Primary;\n    }\n    /**\n     * 关闭升级弹窗\n     */\n    private closeLevelUp() {\n        switch (this._upgradeMode) {\n            case UpgradeMode.Primary:\n                this._levelUpSpine.primaryClose();\n                break;\n            case UpgradeMode.Advanced:\n                this._levelUpSpine.dvancedClose();\n                break;\n            case UpgradeMode.Small:\n                this._levelUpSpine.smallClose();\n                break;\n        }\n        this.hideLevelLabel();\n        this._maskNode.active = false;\n        this.scheduleOnce(() => {\n            this._clickBuffer = 0;\n            this.hide();\n            if (this._closeCallback) {\n                this._closeCallback();\n            }\n        }, 0.5);\n    }\n    /**\n     * 执行金币飞行动画\n     */\n    private coinFly(): void {\n        let coin: Coin = this.addFguiComponent(Coin);\n        let startPos: cc.Vec2;\n        //* 小升级\n        if (this._upgradeMode === UpgradeMode.Small) {\n            startPos = cc.v2(1764 + Math.random() * 200, -250 - Math.random() * 100);\n        }\n        //* 大升级\n        else {\n            startPos = cc.v2(660 + Math.random() * 200, -500 - Math.random() * 100);\n        }\n        coin.onAllChildCreated(() => {\n            coin.coinFly(startPos, this.coinEndPos);\n        });\n    }\n    /**\n     * 执行积分飞行动画\n     */\n    private integralFly(): void {\n        let integral: Integral = this.addFguiComponent(Integral);\n        let startPos: cc.Vec2;\n        //* 小升级\n        if (this._upgradeMode === UpgradeMode.Small) {\n            startPos = cc.v2(1764 + Math.random() * 200, -250 - Math.random() * 100);\n        }\n        //* 大升级\n        else {\n            startPos = cc.v2(660 + Math.random() * 200, -650 - Math.random() * 100);\n        }\n        integral.coinFly(startPos, this.integralEndPos);\n    }\n    /**\n     * 收集按钮点击事件\n     */\n    private collectClick(): void {\n        SoundMgr.getInstance().playEffect(\"button\");\n        //* 大升级弹框的金币动画需要手动触发\n        if (!this.isCoinFly) {\n            this._clickBuffer++;\n            this.isCoinFly = true;\n            this.scheduleOnce(() => {\n                //* 金币飞行音效\n                SoundMgr.getInstance().playEffect(\"frame_coins\");\n            }, 0.5);\n        }\n    }\n    /**\n     * 双击按钮点击事件\n     */\n    private adButtonClick(): void {\n        SoundMgr.getInstance().playEffect(\"button\");\n        this.node.emit(LEVEL_UP_AD);\n    }\n    /**\n     * 绑定广告按钮点击事件\n     * @param listener\n     */\n    public onAdButtonClick(listener: Function): void {\n        this.node.off(LEVEL_UP_AD);\n        this.node.on(LEVEL_UP_AD, listener);\n    }\n    /**\n     * 展示等级\n     * @param level\n     * @param rewardCoins\n     * @param rewardIntegral\n     * @param upgradeMode\n     */\n    private showLevel(level: number, rewardCoins: number, rewardIntegral: number, upgradeMode: UpgradeMode) {\n        if (upgradeMode === UpgradeMode.Small) {\n            this._levelLabelTop.text = level.toString();\n            this._levelLabelTop.visible = true;\n            this._coinLabelTop.text = Utils.formatNumberToInt(rewardCoins);\n            this._coinLabelTop.visible = true;\n            this._integralLabelTop.text = Utils.formatNumberToInt(rewardIntegral);\n            this._integralLabelTop.visible = true;\n        } else {\n            //* 金币增长动画\n            this._coin.gtextField.visible = true;\n            this._coin.gtextField.text = Utils.formatNumberToInt(rewardCoins);\n            this._coin.play(0, rewardCoins, this._coinIncreaseTime);\n            //* 积分增长动画\n            this._integral.gtextField.visible = true;\n            this._integral.gtextField.text = Utils.formatNumberToInt(rewardIntegral);\n            this._integral.play(0, rewardIntegral, this._coinIncreaseTime);\n            //* 等级\n            this._levelLabel.text = level.toString();\n            this._levelLabel.visible = true;\n\n            this._collectButton.visible = true;\n            this._doubleButton.visible = true;\n        }\n    }\n    /**\n     * 隐藏等级文本\n     */\n    private hideLevelLabel() {\n        this._levelLabel.visible = false;\n        this._coin.gtextField.visible = false;\n        this._integral.gtextField.visible = false;\n        this._levelLabelTop.visible = false;\n        this._coinLabelTop.visible = false;\n        this._integralLabelTop.visible = false;\n        this._collectButton.visible = false;\n        this._doubleButton.visible = false;\n    }\n    /**\n     * 金币动画执行完毕回调\n     */\n    private coinFlyCallback(): void {\n        if (this._clickBuffer > 1) {\n            return;\n        }\n        this.scheduleOnce(() => {\n            this._rippleSpine.closeRipple();\n            //* 停止金币飞行音效\n            SoundMgr.getInstance().stopEffect(\"frame_coins\");\n        }, 0.8);\n        this.scheduleOnce(() => {\n            this.closeLevelUp();\n        }, 1.5);\n    }\n\n    update(dt: number) {\n        if (this.isCoinFly) {\n            if (this._rewardCoins && this._rewardCoins > 0 && this._flyCoins > 0) {\n                this._flyCoins -= 2;\n                this.coinFly();\n                this._rippleSpine.ripple();\n            } else if (this._rewardIntegral && this._rewardIntegral > 0 && this._flyIntegrals > 0) {\n                this._flyIntegrals -= 2;\n                this.integralFly();\n            } else {\n                this.isCoinFly = false;\n                this.coinFlyCallback();\n            }\n        }\n    }\n}\n"]}