{"version":3,"sources":["assets\\Script\\Encrypt\\lib\\asn1js\\asn1.js"],"names":["ellipsis","reTimeS","reTimeL","stringCut","str","len","length","substring","Stream","enc","pos","hexDigits","prototype","get","undefined","Error","charCodeAt","hexByte","b","charAt","hexDump","start","end","raw","s","i","isASCII","c","parseStringISO","String","fromCharCode","parseStringUTF","parseStringBMP","hi","lo","parseTime","shortYear","m","exec","parseInteger","v","neg","pad","n","Int10","mulAdd","toString","parseBitString","maxLength","unusedBit","lenBit","intro","skip","j","parseOctetString","parseOID","bits","simplify","sub","ASN1","stream","header","tag","ASN1Tag","typeName","tagClass","tagNumber","content","Infinity","posContent","Math","abs","isUniversal","toPrettyString","indent","tagConstructed","max","posStart","posEnd","toHexString","decodeLength","buf","getHexStringValue","hexString","offset","substr","decode","streamStart","getSub","ret","isEOC","e"],"mappings":"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","sourceRoot":"/","sourcesContent":["// ASN.1 JavaScript decoder\n// Copyright (c) 2008-2014 Lapo Luchini <lapo@lapo.it>\n// Permission to use, copy, modify, and/or distribute this software for any\n// purpose with or without fee is hereby granted, provided that the above\n// copyright notice and this permission notice appear in all copies.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES\n// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF\n// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR\n// ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES\n// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN\n// ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF\n// OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\n/*jshint browser: true, strict: true, immed: true, latedef: true, undef: true, regexdash: false */\n/*global oids */\nimport { Int10 } from \"./int10\";\nvar ellipsis = \"\\u2026\";\nvar reTimeS = /^(\\d\\d)(0[1-9]|1[0-2])(0[1-9]|[12]\\d|3[01])([01]\\d|2[0-3])(?:([0-5]\\d)(?:([0-5]\\d)(?:[.,](\\d{1,3}))?)?)?(Z|[-+](?:[0]\\d|1[0-2])([0-5]\\d)?)?$/;\nvar reTimeL = /^(\\d\\d\\d\\d)(0[1-9]|1[0-2])(0[1-9]|[12]\\d|3[01])([01]\\d|2[0-3])(?:([0-5]\\d)(?:([0-5]\\d)(?:[.,](\\d{1,3}))?)?)?(Z|[-+](?:[0]\\d|1[0-2])([0-5]\\d)?)?$/;\nfunction stringCut(str, len) {\n    if (str.length > len) {\n        str = str.substring(0, len) + ellipsis;\n    }\n    return str;\n}\nvar Stream = /** @class */ (function () {\n    function Stream(enc, pos) {\n        this.hexDigits = \"0123456789ABCDEF\";\n        if (enc instanceof Stream) {\n            this.enc = enc.enc;\n            this.pos = enc.pos;\n        }\n        else {\n            // enc should be an array or a binary string\n            this.enc = enc;\n            this.pos = pos;\n        }\n    }\n    Stream.prototype.get = function (pos) {\n        if (pos === undefined) {\n            pos = this.pos++;\n        }\n        if (pos >= this.enc.length) {\n            throw new Error(\"Requesting byte offset \" + pos + \" on a stream of length \" + this.enc.length);\n        }\n        return (\"string\" === typeof this.enc) ? this.enc.charCodeAt(pos) : this.enc[pos];\n    };\n    Stream.prototype.hexByte = function (b) {\n        return this.hexDigits.charAt((b >> 4) & 0xF) + this.hexDigits.charAt(b & 0xF);\n    };\n    Stream.prototype.hexDump = function (start, end, raw) {\n        var s = \"\";\n        for (var i = start; i < end; ++i) {\n            s += this.hexByte(this.get(i));\n            if (raw !== true) {\n                switch (i & 0xF) {\n                    case 0x7:\n                        s += \"  \";\n                        break;\n                    case 0xF:\n                        s += \"\\n\";\n                        break;\n                    default:\n                        s += \" \";\n                }\n            }\n        }\n        return s;\n    };\n    Stream.prototype.isASCII = function (start, end) {\n        for (var i = start; i < end; ++i) {\n            var c = this.get(i);\n            if (c < 32 || c > 176) {\n                return false;\n            }\n        }\n        return true;\n    };\n    Stream.prototype.parseStringISO = function (start, end) {\n        var s = \"\";\n        for (var i = start; i < end; ++i) {\n            s += String.fromCharCode(this.get(i));\n        }\n        return s;\n    };\n    Stream.prototype.parseStringUTF = function (start, end) {\n        var s = \"\";\n        for (var i = start; i < end;) {\n            var c = this.get(i++);\n            if (c < 128) {\n                s += String.fromCharCode(c);\n            }\n            else if ((c > 191) && (c < 224)) {\n                s += String.fromCharCode(((c & 0x1F) << 6) | (this.get(i++) & 0x3F));\n            }\n            else {\n                s += String.fromCharCode(((c & 0x0F) << 12) | ((this.get(i++) & 0x3F) << 6) | (this.get(i++) & 0x3F));\n            }\n        }\n        return s;\n    };\n    Stream.prototype.parseStringBMP = function (start, end) {\n        var str = \"\";\n        var hi;\n        var lo;\n        for (var i = start; i < end;) {\n            hi = this.get(i++);\n            lo = this.get(i++);\n            str += String.fromCharCode((hi << 8) | lo);\n        }\n        return str;\n    };\n    Stream.prototype.parseTime = function (start, end, shortYear) {\n        var s = this.parseStringISO(start, end);\n        var m = (shortYear ? reTimeS : reTimeL).exec(s);\n        if (!m) {\n            return \"Unrecognized time: \" + s;\n        }\n        if (shortYear) {\n            // to avoid querying the timer, use the fixed range [1970, 2069]\n            // it will conform with ITU X.400 [-10, +40] sliding window until 2030\n            m[1] = +m[1];\n            m[1] += (+m[1] < 70) ? 2000 : 1900;\n        }\n        s = m[1] + \"-\" + m[2] + \"-\" + m[3] + \" \" + m[4];\n        if (m[5]) {\n            s += \":\" + m[5];\n            if (m[6]) {\n                s += \":\" + m[6];\n                if (m[7]) {\n                    s += \".\" + m[7];\n                }\n            }\n        }\n        if (m[8]) {\n            s += \" UTC\";\n            if (m[8] != \"Z\") {\n                s += m[8];\n                if (m[9]) {\n                    s += \":\" + m[9];\n                }\n            }\n        }\n        return s;\n    };\n    Stream.prototype.parseInteger = function (start, end) {\n        var v = this.get(start);\n        var neg = (v > 127);\n        var pad = neg ? 255 : 0;\n        var len;\n        var s = \"\";\n        // skip unuseful bits (not allowed in DER)\n        while (v == pad && ++start < end) {\n            v = this.get(start);\n        }\n        len = end - start;\n        if (len === 0) {\n            return neg ? -1 : 0;\n        }\n        // show bit length of huge integers\n        if (len > 4) {\n            s = v;\n            len <<= 3;\n            while (((+s ^ pad) & 0x80) == 0) {\n                s = +s << 1;\n                --len;\n            }\n            s = \"(\" + len + \" bit)\\n\";\n        }\n        // decode the integer\n        if (neg) {\n            v = v - 256;\n        }\n        var n = new Int10(v);\n        for (var i = start + 1; i < end; ++i) {\n            n.mulAdd(256, this.get(i));\n        }\n        return s + n.toString();\n    };\n    Stream.prototype.parseBitString = function (start, end, maxLength) {\n        var unusedBit = this.get(start);\n        var lenBit = ((end - start - 1) << 3) - unusedBit;\n        var intro = \"(\" + lenBit + \" bit)\\n\";\n        var s = \"\";\n        for (var i = start + 1; i < end; ++i) {\n            var b = this.get(i);\n            var skip = (i == end - 1) ? unusedBit : 0;\n            for (var j = 7; j >= skip; --j) {\n                s += (b >> j) & 1 ? \"1\" : \"0\";\n            }\n            if (s.length > maxLength) {\n                return intro + stringCut(s, maxLength);\n            }\n        }\n        return intro + s;\n    };\n    Stream.prototype.parseOctetString = function (start, end, maxLength) {\n        if (this.isASCII(start, end)) {\n            return stringCut(this.parseStringISO(start, end), maxLength);\n        }\n        var len = end - start;\n        var s = \"(\" + len + \" byte)\\n\";\n        maxLength /= 2; // we work in bytes\n        if (len > maxLength) {\n            end = start + maxLength;\n        }\n        for (var i = start; i < end; ++i) {\n            s += this.hexByte(this.get(i));\n        }\n        if (len > maxLength) {\n            s += ellipsis;\n        }\n        return s;\n    };\n    Stream.prototype.parseOID = function (start, end, maxLength) {\n        var s = \"\";\n        var n = new Int10();\n        var bits = 0;\n        for (var i = start; i < end; ++i) {\n            var v = this.get(i);\n            n.mulAdd(128, v & 0x7F);\n            bits += 7;\n            if (!(v & 0x80)) { // finished\n                if (s === \"\") {\n                    n = n.simplify();\n                    if (n instanceof Int10) {\n                        n.sub(80);\n                        s = \"2.\" + n.toString();\n                    }\n                    else {\n                        var m = n < 80 ? n < 40 ? 0 : 1 : 2;\n                        s = m + \".\" + (n - m * 40);\n                    }\n                }\n                else {\n                    s += \".\" + n.toString();\n                }\n                if (s.length > maxLength) {\n                    return stringCut(s, maxLength);\n                }\n                n = new Int10();\n                bits = 0;\n            }\n        }\n        if (bits > 0) {\n            s += \".incomplete\";\n        }\n        return s;\n    };\n    return Stream;\n}());\nexport { Stream };\nvar ASN1 = /** @class */ (function () {\n    function ASN1(stream, header, length, tag, sub) {\n        if (!(tag instanceof ASN1Tag)) {\n            throw new Error(\"Invalid tag value.\");\n        }\n        this.stream = stream;\n        this.header = header;\n        this.length = length;\n        this.tag = tag;\n        this.sub = sub;\n    }\n    ASN1.prototype.typeName = function () {\n        switch (this.tag.tagClass) {\n            case 0: // universal\n                switch (this.tag.tagNumber) {\n                    case 0x00:\n                        return \"EOC\";\n                    case 0x01:\n                        return \"BOOLEAN\";\n                    case 0x02:\n                        return \"INTEGER\";\n                    case 0x03:\n                        return \"BIT_STRING\";\n                    case 0x04:\n                        return \"OCTET_STRING\";\n                    case 0x05:\n                        return \"NULL\";\n                    case 0x06:\n                        return \"OBJECT_IDENTIFIER\";\n                    case 0x07:\n                        return \"ObjectDescriptor\";\n                    case 0x08:\n                        return \"EXTERNAL\";\n                    case 0x09:\n                        return \"REAL\";\n                    case 0x0A:\n                        return \"ENUMERATED\";\n                    case 0x0B:\n                        return \"EMBEDDED_PDV\";\n                    case 0x0C:\n                        return \"UTF8String\";\n                    case 0x10:\n                        return \"SEQUENCE\";\n                    case 0x11:\n                        return \"SET\";\n                    case 0x12:\n                        return \"NumericString\";\n                    case 0x13:\n                        return \"PrintableString\"; // ASCII subset\n                    case 0x14:\n                        return \"TeletexString\"; // aka T61String\n                    case 0x15:\n                        return \"VideotexString\";\n                    case 0x16:\n                        return \"IA5String\"; // ASCII\n                    case 0x17:\n                        return \"UTCTime\";\n                    case 0x18:\n                        return \"GeneralizedTime\";\n                    case 0x19:\n                        return \"GraphicString\";\n                    case 0x1A:\n                        return \"VisibleString\"; // ASCII subset\n                    case 0x1B:\n                        return \"GeneralString\";\n                    case 0x1C:\n                        return \"UniversalString\";\n                    case 0x1E:\n                        return \"BMPString\";\n                }\n                return \"Universal_\" + this.tag.tagNumber.toString();\n            case 1:\n                return \"Application_\" + this.tag.tagNumber.toString();\n            case 2:\n                return \"[\" + this.tag.tagNumber.toString() + \"]\"; // Context\n            case 3:\n                return \"Private_\" + this.tag.tagNumber.toString();\n        }\n    };\n    ASN1.prototype.content = function (maxLength) {\n        if (this.tag === undefined) {\n            return null;\n        }\n        if (maxLength === undefined) {\n            maxLength = Infinity;\n        }\n        var content = this.posContent();\n        var len = Math.abs(this.length);\n        if (!this.tag.isUniversal()) {\n            if (this.sub !== null) {\n                return \"(\" + this.sub.length + \" elem)\";\n            }\n            return this.stream.parseOctetString(content, content + len, maxLength);\n        }\n        switch (this.tag.tagNumber) {\n            case 0x01: // BOOLEAN\n                return (this.stream.get(content) === 0) ? \"false\" : \"true\";\n            case 0x02: // INTEGER\n                return this.stream.parseInteger(content, content + len);\n            case 0x03: // BIT_STRING\n                return this.sub ? \"(\" + this.sub.length + \" elem)\" :\n                    this.stream.parseBitString(content, content + len, maxLength);\n            case 0x04: // OCTET_STRING\n                return this.sub ? \"(\" + this.sub.length + \" elem)\" :\n                    this.stream.parseOctetString(content, content + len, maxLength);\n            // case 0x05: // NULL\n            case 0x06: // OBJECT_IDENTIFIER\n                return this.stream.parseOID(content, content + len, maxLength);\n            // case 0x07: // ObjectDescriptor\n            // case 0x08: // EXTERNAL\n            // case 0x09: // REAL\n            // case 0x0A: // ENUMERATED\n            // case 0x0B: // EMBEDDED_PDV\n            case 0x10: // SEQUENCE\n            case 0x11: // SET\n                if (this.sub !== null) {\n                    return \"(\" + this.sub.length + \" elem)\";\n                }\n                else {\n                    return \"(no elem)\";\n                }\n            case 0x0C: // UTF8String\n                return stringCut(this.stream.parseStringUTF(content, content + len), maxLength);\n            case 0x12: // NumericString\n            case 0x13: // PrintableString\n            case 0x14: // TeletexString\n            case 0x15: // VideotexString\n            case 0x16: // IA5String\n            // case 0x19: // GraphicString\n            case 0x1A: // VisibleString\n                // case 0x1B: // GeneralString\n                // case 0x1C: // UniversalString\n                return stringCut(this.stream.parseStringISO(content, content + len), maxLength);\n            case 0x1E: // BMPString\n                return stringCut(this.stream.parseStringBMP(content, content + len), maxLength);\n            case 0x17: // UTCTime\n            case 0x18: // GeneralizedTime\n                return this.stream.parseTime(content, content + len, (this.tag.tagNumber == 0x17));\n        }\n        return null;\n    };\n    ASN1.prototype.toString = function () {\n        return this.typeName() + \"@\" + this.stream.pos + \"[header:\" + this.header + \",length:\" + this.length + \",sub:\" + ((this.sub === null) ? \"null\" : this.sub.length) + \"]\";\n    };\n    ASN1.prototype.toPrettyString = function (indent) {\n        if (indent === undefined) {\n            indent = \"\";\n        }\n        var s = indent + this.typeName() + \" @\" + this.stream.pos;\n        if (this.length >= 0) {\n            s += \"+\";\n        }\n        s += this.length;\n        if (this.tag.tagConstructed) {\n            s += \" (constructed)\";\n        }\n        else if ((this.tag.isUniversal() && ((this.tag.tagNumber == 0x03) || (this.tag.tagNumber == 0x04))) && (this.sub !== null)) {\n            s += \" (encapsulates)\";\n        }\n        s += \"\\n\";\n        if (this.sub !== null) {\n            indent += \"  \";\n            for (var i = 0, max = this.sub.length; i < max; ++i) {\n                s += this.sub[i].toPrettyString(indent);\n            }\n        }\n        return s;\n    };\n    ASN1.prototype.posStart = function () {\n        return this.stream.pos;\n    };\n    ASN1.prototype.posContent = function () {\n        return this.stream.pos + this.header;\n    };\n    ASN1.prototype.posEnd = function () {\n        return this.stream.pos + this.header + Math.abs(this.length);\n    };\n    ASN1.prototype.toHexString = function () {\n        return this.stream.hexDump(this.posStart(), this.posEnd(), true);\n    };\n    ASN1.decodeLength = function (stream) {\n        var buf = stream.get();\n        var len = buf & 0x7F;\n        if (len == buf) {\n            return len;\n        }\n        // no reason to use Int10, as it would be a huge buffer anyways\n        if (len > 6) {\n            throw new Error(\"Length over 48 bits not supported at position \" + (stream.pos - 1));\n        }\n        if (len === 0) {\n            return null;\n        } // undefined\n        buf = 0;\n        for (var i = 0; i < len; ++i) {\n            buf = (buf * 256) + stream.get();\n        }\n        return buf;\n    };\n    /**\n     * Retrieve the hexadecimal value (as a string) of the current ASN.1 element\n     * @returns {string}\n     * @public\n     */\n    ASN1.prototype.getHexStringValue = function () {\n        var hexString = this.toHexString();\n        var offset = this.header * 2;\n        var length = this.length * 2;\n        return hexString.substr(offset, length);\n    };\n    ASN1.decode = function (str) {\n        var stream;\n        if (!(str instanceof Stream)) {\n            stream = new Stream(str, 0);\n        }\n        else {\n            stream = str;\n        }\n        var streamStart = new Stream(stream);\n        var tag = new ASN1Tag(stream);\n        var len = ASN1.decodeLength(stream);\n        var start = stream.pos;\n        var header = start - streamStart.pos;\n        var sub = null;\n        var getSub = function () {\n            var ret = [];\n            if (len !== null) {\n                // definite length\n                var end = start + len;\n                while (stream.pos < end) {\n                    ret[ret.length] = ASN1.decode(stream);\n                }\n                if (stream.pos != end) {\n                    throw new Error(\"Content size is not correct for container starting at offset \" + start);\n                }\n            }\n            else {\n                // undefined length\n                try {\n                    for (;;) {\n                        var s = ASN1.decode(stream);\n                        if (s.tag.isEOC()) {\n                            break;\n                        }\n                        ret[ret.length] = s;\n                    }\n                    len = start - stream.pos; // undefined lengths are represented as negative values\n                }\n                catch (e) {\n                    throw new Error(\"Exception while decoding undefined length content: \" + e);\n                }\n            }\n            return ret;\n        };\n        if (tag.tagConstructed) {\n            // must have valid content\n            sub = getSub();\n        }\n        else if (tag.isUniversal() && ((tag.tagNumber == 0x03) || (tag.tagNumber == 0x04))) {\n            // sometimes BitString and OctetString are used to encapsulate ASN.1\n            try {\n                if (tag.tagNumber == 0x03) {\n                    if (stream.get() != 0) {\n                        throw new Error(\"BIT STRINGs with unused bits cannot encapsulate.\");\n                    }\n                }\n                sub = getSub();\n                for (var i = 0; i < sub.length; ++i) {\n                    if (sub[i].tag.isEOC()) {\n                        throw new Error(\"EOC is not supposed to be actual content.\");\n                    }\n                }\n            }\n            catch (e) {\n                // but silently ignore when they don't\n                sub = null;\n            }\n        }\n        if (sub === null) {\n            if (len === null) {\n                throw new Error(\"We can't skip over an invalid tag with undefined length at offset \" + start);\n            }\n            stream.pos = start + Math.abs(len);\n        }\n        return new ASN1(streamStart, header, len, tag, sub);\n    };\n    return ASN1;\n}());\nexport { ASN1 };\nvar ASN1Tag = /** @class */ (function () {\n    function ASN1Tag(stream) {\n        var buf = stream.get();\n        this.tagClass = buf >> 6;\n        this.tagConstructed = ((buf & 0x20) !== 0);\n        this.tagNumber = buf & 0x1F;\n        if (this.tagNumber == 0x1F) { // long tag\n            var n = new Int10();\n            do {\n                buf = stream.get();\n                n.mulAdd(128, buf & 0x7F);\n            } while (buf & 0x80);\n            this.tagNumber = n.simplify();\n        }\n    }\n    ASN1Tag.prototype.isUniversal = function () {\n        return this.tagClass === 0x00;\n    };\n    ASN1Tag.prototype.isEOC = function () {\n        return this.tagClass === 0x00 && this.tagNumber === 0x00;\n    };\n    return ASN1Tag;\n}());\nexport { ASN1Tag };\n"]}