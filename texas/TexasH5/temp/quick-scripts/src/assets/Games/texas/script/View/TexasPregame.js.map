{"version":3,"sources":["assets\\Games\\texas\\script\\View\\TexasPregame.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { cs_base, sc_base, RoomInfoSD } from \"../../../../Script/BaseFrame/cs_base\";\nimport ViewBase from \"../../../../Script/BaseFrame/ViewBase\";\nimport { WebSocketManager } from \"../../../../Script/BaseFrame/WebSocketManager\";\nimport { AppConst } from \"../../../../Script/modules/@slotsmaster/ui-common/lib/AppConst\";\nimport F_TexasViewCtr from \"../Contrl/F_TexasViewCtr\";\nimport F_TexasView from \"./F_TexasView\";\n\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class TexasPregame extends ViewBase {\n    protected get packageResourceName(): string {\n        return \"GameCommon\";\n    }\n    protected get packageName(): string {\n        return \"Common\";\n    }\n    protected get componentName(): string {\n        return \"GameLoading\";\n    }\n    @property(cc.Node)\n    layoutNode: cc.Node = null;\n    @property(cc.Label)\n    tipLabel: cc.Label = null;\n    @property(cc.Node)\n    gameNode: cc.Node = null;\n    @property(cc.ProgressBar)\n    progressBar: cc.ProgressBar = null;\n\n    public ui_btnCreateTable: fgui.GButton = null;\n    public ui_btnEnterTable: fgui.GButton = null;\n    public ui_Text: fgui.GTextField = null;\n\n    private view: F_TexasView = null;\n    private talbeid = \"\";\n\n    private progressBarCB: Function = null;\n    private progressBarCB2: Function = null;\n\n    onLoad() {\n        F_TexasViewCtr.instance;\n        super.onLoad();\n        fgui.addLoadHandler();\n        fgui.GRoot.create();\n        this.layoutNode.active = true;\n        this.gameNode.active = false;\n        let times = 0;\n        this.tipLabel.string = \"Loading\";\n        this.progressBarCB = () => {\n            times += 1;\n            let tipString = \"\";\n            if (times % 4 == 1) {\n                tipString = \"Loading.\";\n            } else if (times % 4 == 2) {\n                tipString = \"Loading..\";\n            } else if (times % 4 == 3) {\n                tipString = \"Loading...\";\n            } else if (times % 4 == 0) {\n                tipString = \"Loading\";\n            }\n            this.tipLabel.string = tipString;\n            if (times >= 4) {\n                times = 0;\n            }\n        }\n        this.schedule(() => {\n            this.progressBarCB();\n        }, 0.3)\n\n        let time: number = 0;\n        this.progressBar.barSprite.fillRange = time;\n        this.progressBarCB2 = () => {\n            time += 0.08;\n            this.progressBar.barSprite.fillRange = time;\n            this.tipLabel.string = \"Loading...\" + Math.ceil(time * 100) + \"%\";\n            if (time >= 0.98) {\n                this.unscheduleAllCallbacks();\n                this.cs_getgamelevel();\n                return;\n            } else if (time >= 0.6) {\n                time -= 0.03;\n            }\n        }\n        this.schedule(() => {\n            this.progressBarCB2();\n        }, 0.05)\n    }\n\n    createChildComponents() {\n        super.createChildComponents();\n        fgui.GRoot.inst.addChild(this.fguiComponent);\n        // if (this.view) {\n        //     this.view.fguiComponent.visible = true;\n        //     this.view.initManager();\n        // } else {\n        // this.view = this.addComponent(F_TexasView);\n        // }\n\n    }\n\n    allChildCreated() {\n        super.allChildCreated();\n        this.ui_btnCreateTable.visible = false;\n        this.ui_btnEnterTable.visible = false;\n        this.ui_Text.text = \"\";\n        F_TexasViewCtr.instance.sc_entertablenum_tex(AppConst.enterTableData);\n        F_TexasViewCtr.instance.Model.mPlayerModel = AppConst.mPlayerModel;\n        // this.cs_getgamelevel();\n        //     if(AppConst.roomId == \"\")\n        //     {\n        //         this.ui_Text.text = \"正在登录中...\";\n        //         AppConst.currentGameId =  51;\n        //         AppConst.currentlevelid = 511;\n        //         WebSocketManager.getInstance.GateServer(window.Ip || \"106.13.222.130\"); \n        //         WebSocketManager.getInstance.GatePort(10002); \n        //         WebSocketManager.getInstance.EnterRoomCallback =this.LoginSuccess.bind(this);\n        //         WebSocketManager.getInstance.LoginByPIDPWD(window.user_account,window.user_pwd)\n        //     }    \n        //     else\n        //     {\n        //         F_TexasViewCtr.instance.Model.mPlayerModel = AppConst.mPlayerModel;\n        //         this.ui_Text.text = \"正在进入房间...\";\n        //         this.ui_btnCreateTable.visible = false;\n        //         this.ui_btnEnterTable.visible = false;\n        //         this.cs_entertablenum_tex(AppConst.roomId); \n        //     } \n        //     WebSocketManager.getInstance.webSocket.setRefreshCallback(this.cs_entertablenum_tex.bind(this));\n    }\n\n    OnLoadCompleted() {\n        // this.layoutNode.active = false;\n        // 加载完毕 取消loading\n        // this.unschedule(this.progressBarCB);\n    }\n\n    public cs_getgamelevel() {\n        let data: cs_getgamelevel = new cs_getgamelevel();\n        data.gameid = F_TexasViewCtr.instance.Model.gameid;\n        data.fn = \"cs_getgamelevel\";\n        WebSocketManager.getInstance.Send(JSON.stringify(data), this.sc_getgamelevel.bind(this));\n    }\n    public sc_getgamelevel(data: sc_getgamelevel) {\n        if (data.result == 1) {\n            console.log(\"AppConst.currentlevelid = 1\" + AppConst.currentlevelid);\n            F_TexasViewCtr.instance.Model.gamelevel = data.levellist.find(item => AppConst.currentlevelid == item.id);\n            if (F_TexasViewCtr.instance.Model.gamelevel != null) {\n                this.gameNode.active = true;\n            } else {\n                console.log(\"gamelevel is null\");\n            }\n        }\n\n    }\n\n    // public LoginSuccess()\n    // {\n    //     this.cs_getgamelevel();\n    //     F_TexasViewCtr.instance.Model.mPlayerModel = AppConst.mPlayerModel ;\n    //     this.talbeid = cc.sys.localStorage.getItem(\"tableid\");\n    //     if(this.talbeid && this.talbeid!=\"\"){\n    //         this.ui_Text.text = \"登录完成,可以选择进入房间：\" + this.talbeid;\n    //     }else{\n    //         this.ui_Text.text = \"登录完成,请创建房间！\";\n    //         this.ui_btnEnterTable.visible=false;\n    //     }\n\n    //     // //正在房间直接进入\n    //     if(AppConst.gameId  != AppConst.currentGameId && AppConst.gameId != 0){\n    //         this.ui_Text.text = \"登录失败，您正在其他游戏中！\";\n    //         return;\n    //     }\n\n    //     // AppConst.mPlayerModel.state = 539963/////////////测试，直接进入房间\n\n    //     if(AppConst.mPlayerModel.state!=0){\n    //         this.talbeid = AppConst.mPlayerModel.state.toString();\n    //         this.cs_entertablenum_tex(this.talbeid);\n    //      }\n\n    //     this.ui_btnCreateTable.onClick(()=>{this.createtable();});\n    //     this.ui_btnEnterTable.onClick(()=>{this.cs_entertablenum_tex(this.talbeid);});  \n\n    // }\n\n    // private createtable(){\n    //     this.ui_Text.text = \"正在进入房间...\";\n    //     this.ui_btnCreateTable.visible=false;\n    //     this.ui_btnEnterTable.visible=false;\n    //     F_TexasViewCtr.instance.CreateTableCallBack = this.cs_entertablenum_tex.bind(this);\n    //     F_TexasViewCtr.instance.cs_createtable_tex(); \n    // }\n\n\n    // public cs_entertablenum_tex(tableid:string =\"\")\n    // {\n    //     if(tableid!=\"\") cc.sys.localStorage.setItem(\"tableid\",tableid);\n    //     this.talbeid = cc.sys.localStorage.getItem(\"tableid\");\n\n    //     console.log(\"cs_entertablenum_tex talbeid=\"+this.talbeid);\n    //     let data:cs_entertablenum_tex = new cs_entertablenum_tex(); \n    //     // data.levelid = F_TexasViewCtr.instance.Model.levelid;\n    //     // data.tableid = Number.parseInt(this.talbeid);\n    //     data.tnumber = this.talbeid;\n    //     data._g = F_TexasViewCtr.instance.Model.gameid ;\n    //     data.fn = \"cs_entertablenum_tex\"; \n    //     WebSocketManager.getInstance.Send(JSON.stringify(data),this.sc_entertablenum_tex.bind(this));\n    // }\n\n    public entertable() {\n        // if (this.view) {\n        //     this.view.fguiComponent.visible = true;\n        //     this.view.initManager();\n        // } else {\n        //     this.view = this.addComponent(F_TexasView)\n        // }\n    }\n}\n\nexport class cs_getgamelevel extends cs_base {\n    public gameid: number;\n}\n\nexport class sc_getgamelevel extends sc_base {\n\n    public levellist: RoomInfoSD[];\n}\n"]}