{"version":3,"sources":["assets\\Script\\modules\\@mogafa\\fairygui-component\\lib\\extensions\\MogafaNumberField.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { Utils } from \"../../../utils/lib/Utils\";\n\n\nexport class MogafaNumberField extends cc.Component {\n    private runTime: number = 0;\n    private maxTime: number = 0;\n    private running: boolean = false;\n\n    private _min?: number = null;\n    private _max?: number = null;\n    private _gtextField?: fgui.GTextField = null;\n    public static instanceArr: MogafaNumberField[] = [];\n    private _callback: Function;\n    constructor(textField: fgui.GTextField) {\n        super();\n        this.unschedule(this.scheduleNumber);\n        this._gtextField = textField;\n        this.schedule(this.scheduleNumber, 0);\n        MogafaNumberField.instanceArr.push(this);\n    }\n\n    public static clearInstanceArr(): void {\n        MogafaNumberField.instanceArr = [];\n    }\n\n    public static destroyInstanceArr(callback?: Function): void {\n        MogafaNumberField.instanceArr.map((item, index) => {\n            item.clear();\n        });\n        if (callback) {\n            callback();\n        }\n    }\n    public clear() {\n        this._min = null;\n        this._max = null;\n        this.unschedule(this.scheduleNumber);\n    }\n    public get gtextField(): fgui.GTextField {\n        return this._gtextField;\n    }\n    /**\n     *\n     * @param min 设置开始值\n     * @param max 设置终点值\n     * @param step 时间\n     */\n    public play(min: number, max: number, step: number, callback?: Function) {\n        this.schedule(this.scheduleNumber, 0);\n        this._min = min;\n        this._max = max;\n        this.maxTime = step;\n        this.runTime = 0;\n        this.running = true;\n        this._callback = callback;\n    }\n\n    private scheduleNumber() {\n        if (!this.running) return;\n        this.runTime += 0.015;\n        if (!this.maxTime) {\n            this.setValue(this._max);\n        }\n        if (this.maxTime == -1) {\n            this._min += 100;\n\n            if (this._min >= this._max) {\n                this._min = this._max;\n            }\n            this.setValue(this._min);\n        } else {\n            let radio = this.runTime / this.maxTime;\n\n            radio = Math.max(0, Math.min(1, radio));\n\n            let value = cc.misc.lerp(this._min, this._max, radio);\n            if (value) {\n                this.setValue(value);\n            }\n\n            if (this.maxTime != -1 && this.runTime >= this.maxTime) {\n                this.running = false;\n                this.finish();\n            }\n        }\n    }\n\n    public cancelPlay(): void {\n        this.unschedule(this.scheduleNumber);\n    }\n\n    private finish() {\n        if (this._callback) {\n            this._callback();\n        }\n    }\n\n    public setValue(value: number) {\n        this._gtextField.text = Utils.formatNumberToInt(value, 0);\n    }\n\n    /**\n     * 设置\n     * @param min 最小值\n     */\n    public set min(min: number) {\n        this._min = min;\n        if (this._max != null) {\n            this._gtextField.text = `${this._max}-${this._min}`;\n        }\n    }\n    public set max(max: number) {\n        this._max = max;\n        if (this._min != null) {\n            this._gtextField.text = `${this._min}-${this._max}`;\n        }\n    }\n}\n\n(fgui.GObject.prototype as any).asMogafaNumberField = function (): MogafaNumberField {\n    return new MogafaNumberField(this.asTextField);\n};\n"]}