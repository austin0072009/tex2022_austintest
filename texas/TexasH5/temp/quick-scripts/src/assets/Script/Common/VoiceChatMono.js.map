{"version":3,"sources":["assets\\Script\\Common\\VoiceChatMono.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,kDAA6C;AAEvC,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAA2C,iCAAQ;IAAnD;QAAA,qEA0HC;QA/Ga,8BAAwB,GAAW,KAAK,CAAC,CAAE,SAAS;QAKpD,WAAK,GAAY,KAAK,CAAC;QAGxB,gBAAU,GAAU,EAAE,CAAC;QACvB,gBAAU,GAAU,IAAI,CAAC;;QAkDlC,+FAA+F;QAC/F,IAAI;QACJ,qCAAqC;QACrC,QAAQ;QACR,kCAAkC;QAClC,kBAAkB;QAClB,QAAQ;QACR,2BAA2B;QAC3B,QAAQ;QACR,kCAAkC;QAClC,kBAAkB;QAClB,QAAQ;QAER,qBAAqB;QACrB,oBAAoB;QACpB,wBAAwB;QACxB,+FAA+F;QAC/F,IAAI;QAEJ,6FAA6F;QAC7F,IAAI;QACJ,wDAAwD;QACxD,kBAAkB;QAElB,qBAAqB;QAErB,mCAAmC;QAEnC,yBAAyB;QACzB,kBAAkB;QAElB,yCAAyC;QACzC,yCAAyC;QAEzC,qEAAqE;QACrE,wBAAwB;QACxB,kBAAkB;QAClB,gEAAgE;QAChE,8CAA8C;QAC9C,kBAAkB;QAElB,kBAAkB;QAClB,4DAA4D;QAE5D,gCAAgC;QAChC,QAAQ;QACR,6BAA6B;QAC7B,QAAQ;QAER,IAAI;IAGR,CAAC;IAxHG,sBAAc,8CAAmB;aAAjC;YACI,OAAO,WAAW,CAAC;QACvB,CAAC;;;OAAA;IACD,sBAAc,sCAAW;aAAzB;YACI,OAAO,WAAW,CAAC;QACvB,CAAC;;;OAAA;IACD,sBAAc,wCAAa;aAA3B;YACI,OAAO,WAAW,CAAC;QACvB,CAAC;;;OAAA;IAeM,6BAAK,GAAZ;QAEI,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;QACrB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;IAC3B,CAAC;IAEQ,+BAAO,GAAhB,UAAmB,YAA0B;QAA1B,6BAAA,EAAA,mBAA0B;QAEzC,2CAA2C;QAC3C,IAAI,YAAY,IAAI,IAAI;YACxB,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;QACjC,IAAI,CAAE,wBAAwB,GAAG,IAAI,CAAC;QACtC,qBAAqB;QACrB,qCAAqC;QACrC,IAAI;QACJ,2CAA2C;QAC3C,6BAA6B;QAC7B,IAAI;QACJ,OAAO;QACP,IAAI;QACJ,8BAA8B;QAC9B,IAAI;QACJ,+FAA+F;QAC/F,2FAA2F;IAC/F,CAAC;IAGD,kCAAkC;IAChC,8BAAM,GAAN;QAEE,IAAI,IAAI,CAAC,KAAK,EACd;YACI,+BAA+B;YAC/B,qCAAqC;YACrC,IAAI;YACJ,4BAA4B;YAC5B,qCAAqC;YACrC,kCAAkC;YAClC,QAAQ;YACR,kCAAkC;YAClC,QAAQ;YACR,IAAI;SACP;IACL,CAAC;IApEgB,aAAa;QADjC,OAAO;OACa,aAAa,CA0HjC;IAAD,oBAAC;CA1HD,AA0HC,CA1H0C,kBAAQ,GA0HlD;kBA1HoB,aAAa","file":"","sourceRoot":"/","sourcesContent":["import ViewBase from \"../BaseFrame/ViewBase\";\n \nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class VoiceChatMono extends ViewBase {\n\n    protected get packageResourceName(): string {\n        return \"bullfight\";\n    }\n    protected get packageName(): string {\n        return \"bullfight\";\n    }\n    protected get componentName(): string {\n        return \"bullfight\";\n    }\n    private   mHasMicroPhonePermission:boolean = false;  //查看麦克风权限\n    private  mDeviceName:string;\n    private   mHasMicroPhone:boolean ;\n\n    private   mCostTime:boolean;\n    private   mFlag :boolean = false;\n    private   mDisplayTime:number;\n    public   mLoop:boolean \n    public   mLengthSec:number = 10;\n    public   mFrequency:number = 8000;\n    private  mAudioCli:cc.AudioClip;\n    public   ui_btnYuYin:cc.Node;\n    public  mRetirnVoice:Function;//Function<string>;\n\n    public Awake() :void\n    {\n        this.mLengthSec = 10;\n        this.mFrequency = 8000;\n    }\n\n    public   MyStart(  _retirnVoice:Function=null):void\n    {\n        //base.AutoSetGoProperty(this, gameObject);\n        if (_retirnVoice != null)\n        this.mRetirnVoice = _retirnVoice;\n        this. mHasMicroPhonePermission = true;\n        // 判断是否有麦克风 有则默认使用第一个\n        // if (Microphone.devices.Length > 0)\n        // {\n        //     mDeviceName = Microphone.devices[0];\n        //     mHasMicroPhone = true;\n        // }\n        // else\n        // {\n        //     mHasMicroPhone = false;\n        // }\n        // ZUIEventListener.OverWriteCallBack(ui_btnYuYin.gameObject, _OnVoiceDown, ZUIEventType.Down);\n        // ZUIEventListener.OverWriteCallBack(ui_btnYuYin.gameObject, _OnVoiceUp, ZUIEventType.Up);\n    }\n\n\n    // Update is called once per frame\n      Update():void\n    {\n        if (this.mFlag)\n        {\n            // mCostTime += Time.deltaTime;\n            // if ((int)mCostTime > mDisplayTime)\n            // {\n            //     Debug.Log(mCostTime);\n            //     mDisplayTime = (int)mCostTime;\n            //     if (mCostTime > mLengthSec)\n            //     {\n            //         _OnVoiceUp(null, null);\n            //     }\n            // }\n        }\n    }\n\n    // private   _OnVoiceDown(GameObject arg1, UnityEngine.EventSystems.PointerEventData arg2):void\n    // {\n    //     if (!mHasMicroPhonePermission)\n    //     {\n    //         Debuger.Log(\"没有麦克风权限\");\n    //         return;\n    //     }\n    //     if (!mHasMicroPhone)\n    //     {\n    //         Debuger.Log(\"没有插入麦克风\");\n    //         return;\n    //     }\n\n    //     mCostTime = 0;\n    //     mFlag = true;\n    //     mDisplayTime = 0;\n    //     mAudioClip = Microphone.Start(mDeviceName, mLoop, mLengthSec, mFrequency);       //44100\n    // }\n\n    // private   _OnVoiceUp(GameObject arg1, UnityEngine.EventSystems.PointerEventData arg2):void\n    // {\n    //     if (!mHasMicroPhonePermission || !mHasMicroPhone)\n    //         return;\n\n    //     mFlag = false;\n\n    //     Microphone.End(mDeviceName);\n\n    //     if (mCostTime < 1)\n    //         return;\n\n    //     if (mCostTime > mAudioClip.length)\n    //         mCostTime = mAudioClip.length;\n\n    //     float[] data = AudioClipConverter.Trim(mAudioClip, mCostTime);\n    //     if (data == null)\n    //         return;\n    //     byte[] voice = AudioClipConverter.AudioClipToBytes(data);\n    //     if (voice == null || voice.Length == 0)\n    //         return;\n        \n    //     //发送的语言内容转换\n    //     string str = AudioClipConverter.BytesToString(voice);\n\n    //     if (mRetirnVoice != null)\n    //     {\n    //         mRetirnVoice(str);\n    //     }\n \n    // }\n  \n\n}\n"]}