{"version":3,"sources":["assets\\Script\\AppLoad.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import \"reflect-metadata\"\nimport { BaseFrameNative } from \"./BaseFrameNative\";\nimport HotUpdateManager from \"./HotUpdateManager\";\nimport { MgrNative } from \"./MgrNative\";\nimport { JSEncrypt } from \"./Encrypt/jsencrypt\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class AppLoad extends cc.Component {\n    @property(cc.JsonAsset)\n    defaultJsonConfig: cc.JsonAsset = null;\n\n    @property(cc.Label)\n    oldLabel: cc.Label = null;\n\n    @property(cc.Label)\n    newLabel: cc.Label = null;\n\n    @property(cc.Label)\n    tipLabel: cc.Label = null;\n\n    @property(cc.Label)\n    percentLabel: cc.Label = null;\n\n    @property(cc.Node)\n    percentNode: cc.Node = null;\n\n    @property(cc.Node)\n    remindLabel: cc.Node = null;\n\n    @property(cc.Node)\n    remindNode: cc.Node = null;\n\n    private newVersion: string = \"\";\n    public loadSubpackageName = [\"GameCommon\", \"gameHall\"];\n    private homeurl: string = \"\";\n    private homeurlList: string[] = [];\n    private clientVersion: string = \"\";\n    private severVersion: string = \"\";\n    private serverIndex: number = 0;\n    private serverListUrl: string = \"\";\n    private isNoNetWork: boolean = false;\n    private timer: NodeJS.Timeout = null;\n    private loadingCallBack: Function = null;\n\n    onLoad() {\n        BaseFrameNative.isOpenApp = true;\n        this.remindLabel.active = false;\n        this.remindNode.active = false;\n        // 设置搜索路径\n        if (cc.sys.isNative) {\n            // jsb.fileUtils.setSearchPaths([]);\n            this.addSearchPaths(jsb.fileUtils.getWritablePath());\n            this.addSearchPaths(jsb.fileUtils.getWritablePath() + \"HotUpdate/\");\n            let searchPaths = cc.sys.localStorage.getItem('HotUpdateSearchPaths');\n            if (searchPaths != null && searchPaths != undefined) {\n                // jsb.fileUtils.setSearchPaths(searchPaths);\n                searchPaths = JSON.parse(searchPaths);\n                console.log(\"---searchPaths---\" + searchPaths);\n                for (let index = 0; index < searchPaths.length; index++) {\n                    const element = searchPaths[index];\n                    this.addSearchPaths(element);\n                }\n            }\n            console.log(\"---searchPaths---\" + jsb.fileUtils.getSearchPaths());\n        }\n        // loading动画\n        let times: number = 0;\n        this.tipLabel.string = \"Loading...\"\n        this.loadingCallBack = function () {\n            times += 1;\n            if (times % 4 == 1) {\n                this.tipLabel.string = \"Loading\"\n            } else if (times % 4 == 2) {\n                this.tipLabel.string = \"Loading.\"\n            } else if (times % 4 == 3) {\n                this.tipLabel.string = \"Loading..\"\n            } else if (times % 4 == 0) {\n                times = 0;\n                this.tipLabel.string = \"Loading...\"\n            }\n        }\n        this.schedule(this.loadingCallBack, 0.5);\n    }\n\n    onEnable() {\n        console.log(\"cc.sys.os == \", cc.sys.os);\n        console.log(\"cc.sys.OS_ANDROID == \", cc.sys.OS_ANDROID);\n        let net: string = \"\";\n        if (cc.sys.isNative && cc.sys.os == cc.sys.OS_ANDROID) {\n            /**获取网络状态 */\n            let methodSignature = \"()Ljava/lang/String;\";\n            let method1 = \"getNetWorkInfo\";\n            net = jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/TSJavaBridge\", method1, methodSignature);\n            console.log(\"net === \", net);\n        } else if (cc.sys.isNative && cc.sys.os == cc.sys.OS_IOS) {\n            net = jsb.reflection.callStaticMethod(\"TSObjectCBridge\", \"getNetworkType\");\n        }\n        let netArr = net.split(\"_\");\n        if (netArr[0] == \"-1\") {\n            this.remindNode.active = true;\n            let label = cc.find(\"updateLabel\", this.remindNode);\n            let tipStr: string = \"网络连接不可用，请检查网络！\";\n            label.getComponent(cc.Label).string = tipStr;\n            this.isNoNetWork = true;\n            return;\n        }\n        \n        this.isNoNetWork = false;\n        this.serverIndex = 0;\n        let dezhou_serverlist = cc.sys.localStorage.getItem(\"dezhou_serverlist\");\n        console.log(\"=======\"+dezhou_serverlist+\"=======\");\n        if (dezhou_serverlist === undefined || dezhou_serverlist === null) {\n            BaseFrameNative.defaultServerList = this.defaultJsonConfig.json;\n        } else {\n            BaseFrameNative.defaultServerList = JSON.parse(dezhou_serverlist);\n            console.log(\"1=======\"+BaseFrameNative.defaultServerList+\"=======\");\n        }\n        this.homeurlList = this.defaultJsonConfig.json.home_url.split(\"|\");\n        this.clientVersion = this.getClientVersion();\n        console.log(\"2=======\"+this.homeurlList+\"=======\");\n        // this.serverListUrl = cc.sys.localStorage.getItem(\"dezhou_serverlist_url\");\n        if (this.serverListUrl == undefined || this.serverListUrl == null) {\n            console.log(\"this.serverListUrl == \", this.serverListUrl);\n            this.serverListUrl = \"\";\n        }\n        this.remoteServerList();\n    }\n\n    onDestroy() {\n        if (this.timer) {\n            clearTimeout(this.timer);\n        }\n        this.unscheduleAllCallbacks();\n    }\n\n    // 添加搜索路径\n    public addSearchPaths(path: string) {\n        let pathList = jsb.fileUtils.getSearchPaths();\n        for (let index = 0; index < pathList.length; index++) {\n            let tempPath = pathList[index];\n            if (tempPath == path) {\n                return;\n            }\n        }\n        // 没有加到搜索路径\n        pathList.unshift(path);\n        jsb.fileUtils.setSearchPaths(pathList);\n    }\n\n    // 远程加载serverlist\n    public remoteServerList() {\n        let self = this;\n        this.timer = setTimeout(() => {\n            console.log(\"--- time out ---\");\n            self.loadJsonFail();\n            xhr.abort();//请求中止\n        }, 3000);\n        let callback = function reqListener() {\n            if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\n                if (self.timer) {\n                    clearTimeout(self.timer);\n                }\n                console.log(\"success\");\n                if (self.isStringToJson(xhr.response)) {\n                    let rsp = JSON.parse(xhr.response);\n                    self.loadJsonSuccess(rsp);\n                } else {\n                    // 是加密数据\n                    let rsp = self.JSONDecrypt(xhr.response);\n                    if (self.isStringToJson(rsp)) {\n                        self.loadJsonSuccess(JSON.parse(rsp));\n                    } else {\n                        self.remindNode.active = true;\n                        let label = cc.find(\"updateLabel\", self.remindNode);\n                        let tipStr: string = \"拉取配置文件格式错误，请重试！\";\n                        label.getComponent(cc.Label).string = tipStr;\n                        self.isNoNetWork = true;\n                    }\n                }\n            } else if (xhr.readyState == 4 && xhr.status == 404) {\n                console.log(\"fail 404\");\n                self.loadJsonFail();\n            }\n        }\n        if (this.serverListUrl != \"\") {\n            self.serverIndex = -1;\n            self.homeurl = this.serverListUrl;\n            this.serverListUrl = \"\";\n        } else {\n            self.homeurl = self.homeurlList[self.serverIndex];\n        }\n        let xhr = new XMLHttpRequest();\n        if (cc.sys.isBrowser) {\n            xhr.onreadystatechange = function () {\n                console.log(\"xhr == \", xhr);\n                if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\n                    if (self.timer) {\n                        clearTimeout(self.timer);\n                    }\n                    //解析获取到的文本文件，转化成JSON\n                    if (self.isStringToJson(xhr.response)) {\n                        let rsp = JSON.parse(xhr.response);\n                        self.loadJsonSuccess(rsp);\n                    } else {\n                        // 是加密数据\n                        let rsp = self.JSONDecrypt(xhr.response);\n                        if (self.isStringToJson(rsp)) {\n                            self.loadJsonSuccess(JSON.parse(rsp));\n                        } else {\n                            self.remindNode.active = true;\n                            let label = cc.find(\"updateLabel\", self.remindNode);\n                            let tipStr: string = \"拉取配置文件格式错误，请重试！\";\n                            label.getComponent(cc.Label).string = tipStr;\n                            self.isNoNetWork = true;\n                        }\n                    }\n                }\n            };\n            xhr.onerror = function () {\n                self.loadJsonFail();\n            }\n        } else {\n            xhr.addEventListener(\"load\", callback);\n        }\n        console.log(\"self.homeurl === \", self.homeurl);\n        let nowTime = new Date().getTime();\n        xhr.open(\"GET\", self.homeurl + \"?t=\" + nowTime, true);\n        xhr.send();\n    }\n\n    public isStringToJson(str: string) {\n        try {\n            if (typeof JSON.parse(str) == \"object\") {\n                return true;\n            }\n        } catch (e) {\n\n        }\n        return false;\n    }\n\n    public JSONEncrypt(str: string) {\n        // let encrypt = require(\"encryptjs\")\n        // let dataString = JSON.stringify(str);\n        // let secretkey = 'texas2022'; // 加密密钥\n        // let encrypted = encrypt.encrypt(dataString, secretkey, 256);\n        // cc.log('原始字符串:' + dataString);\n        // cc.log('加密后:' + encrypted);\n\n        let CryptoJS = require(\"CryptoJS\");\n        let dataString = JSON.stringify(str);\n        let secretkey = 'texas2022'; // 加密密钥\n        let encrypted = CryptoJS.AES.encrypt(dataString, secretkey, 256);\n        cc.log('原始字符串:' + dataString);\n        cc.log('加密后:' + encrypted);\n    }\n\n    public JSONDecrypt(str: string) {\n        // let encrypt = require(\"encryptjs\")\n        // let dataString = JSON.stringify(str);\n        // let secretkey = 'texas2022'; // 加密密钥\n        // let myString = JSON.parse(encrypt.decrypt(dataString, secretkey, 256));\n        // cc.log('原始字符串:' + dataString);\n        // cc.log('解密后看看对不对:' + myString);\n\n        let CryptoJS = require(\"CryptoJS\");\n        let dataString = str;\n        let secretkey = 'texas2022'; // 加密密钥\n        let myString = CryptoJS.AES.decrypt(dataString, secretkey, 256);\n        myString = myString.toString(CryptoJS.enc.Utf8).toString();\n        cc.log('原始字符串:' + dataString);\n        cc.log('解密后看看对不对:' + myString);\n        // myString = JSON.parse(myString);\n        return myString;\n    }\n\n    // 加载json成功\n    public loadJsonSuccess(rsp) {\n        this.unschedule(this.loadingCallBack);\n        this.remindLabel.active = false;\n        let serverListUrl: string = this.homeurl;\n        cc.sys.localStorage.setItem(\"dezhou_serverlist_url\", serverListUrl);\n        BaseFrameNative.serverList = rsp;\n        BaseFrameNative.defaultServerList = rsp;\n        console.log(\"rsp == \", rsp);\n        cc.sys.localStorage.setItem(\"dezhou_serverlist\", JSON.stringify(rsp));\n        let nowTime = new Date().getTime();\n        cc.sys.localStorage.setItem(\"dezhou_serverlist_time\", nowTime);\n        let isNeedDownLoadApp: boolean = this.checkAppVersion(); //对比大版本\n        if (isNeedDownLoadApp) {\n            this.remindNode.active = true;\n            let label = cc.find(\"updateLabel\", this.remindNode);\n            let tipStr: string = \"检测到有新版本\" + this.newVersion + \"，请及时更新！\";\n            label.getComponent(cc.Label).string = tipStr;\n            return;\n        }\n        this.checkVersion();\n    }\n\n\n    //跳转外部浏览器\n    public jumpOpenURL() {\n        if (this.isNoNetWork) {\n            cc.game.restart();\n        } else {\n            // 跳转到外部浏览器\n            let url: string = \"\";\n            if (cc.sys.os = cc.sys.OS_ANDROID) {\n                url = BaseFrameNative.serverList.apksite;\n            } else if (cc.sys.os = cc.sys.OS_IOS) {\n                url = BaseFrameNative.serverList.ipasite;\n            }\n            cc.sys.openURL(url);\n        }\n    }\n\n    // 加载json失败\n    public loadJsonFail() {\n        let self = this;\n        self.serverListUrl = \"\";\n        self.serverIndex += 1;\n        console.log(\"--------err--------\", self.serverIndex);\n        if (self.serverIndex >= self.homeurlList.length) {\n            console.log(\"获取服务器配置失败，请检查网络！\");\n            // 未拉取到Json \n            // 修改为判断如果有一天内的serverlist也可以进，否则不让进\n            let nowTime = new Date().getTime();\n            let oldTime = cc.sys.localStorage.getItem(\"dezhou_serverlist_time\");\n            let list = cc.sys.localStorage.getItem(\"dezhou_serverlist\");\n            // 86400000毫秒 = 24小时\n            if ((oldTime == undefined || oldTime == null) || (list == undefined || list == null) || nowTime - oldTime >= 86400000) {\n                console.log(\"本地缓存配置1\");\n                self.remindNode.active = true;\n                let label = cc.find(\"updateLabel\", self.remindNode);\n                let tipStr: string = \"获取配置文件失败，请重试！\";\n                label.getComponent(cc.Label).string = tipStr;\n                self.isNoNetWork = true;\n                cc.sys.localStorage.removeItem(\"dezhou_serverlist\");\n                cc.sys.localStorage.removeItem(\"dezhou_serverlist_time\");\n                return;\n            } else {\n                console.log(\"本地缓存配置2\");\n                this.loadJsonSuccess(JSON.parse(list));\n                return;\n            }\n        }\n        self.remoteServerList();\n    }\n\n    // 获取当前客户端的版本号\n    public getClientVersion(): string {\n        let clientVersion: string = \"\";\n        let localVersion = cc.sys.localStorage.getItem(\"clientVersion\");\n        if (localVersion === undefined || localVersion === null) {\n            clientVersion = BaseFrameNative.VERSION;\n        } else {\n            clientVersion = localVersion;\n        }\n        BaseFrameNative.VERSION = clientVersion;\n        return clientVersion;\n    }\n\n    /**\n     * 对比服务器与本地版本号\n     */\n    public checkVersion() {\n        this.severVersion = this.getHallVersion();\n        if (this.severVersion === null) {\n            console.log(\"获取大厅版本信息错误！\");\n            return;\n        }\n        console.log(\"BaseFrameNative.defaultServerList.mastHotUpdate = \", BaseFrameNative.defaultServerList.mastHotUpdate);\n        if (BaseFrameNative.defaultServerList.mastHotUpdate) {\n            this.gotoUpdate();\n            return;\n        }\n\n        console.log(`服务器版本：${this.severVersion}` + `客户端版本：${this.clientVersion}`);\n        this.oldLabel.string = \"当前版本:\" + this.clientVersion;\n        this.newLabel.string = \"最新版本:\" + this.severVersion;\n        BaseFrameNative.VERSION = this.severVersion;\n        let compareResult: boolean = this.versionCompareHandle(this.clientVersion, this.severVersion);\n        console.log(compareResult);\n        console.log(cc.sys.isNative);\n        console.log(BaseFrameNative.isNeedUpdate);\n        if (!compareResult || !cc.sys.isNative || !BaseFrameNative.isNeedUpdate) {\n            if (!cc.sys.isNative) {\n                console.log(\"浏览器，不需要热更\");\n            }\n            if (!compareResult) {\n                console.log(\"客户端版本大于等于服务器版本，不需要热更\");\n            }\n            this.loadSubpackage(0);\n        } else {\n            console.log(\"客户端版本低于服务器版本，需要热更\");\n            this.gotoUpdate();\n        }\n    }\n\n    // 去热更新\n    public gotoUpdate() {\n        // cc.director.loadScene(\"dlc\");\n        // this.hotUpdateNode.active = true;\n        HotUpdateManager.instance.checkUpdate(this.redirectToLogin.bind(this), this);\n    }\n\n    // 去登录\n    public redirectToLogin() {\n        // 预加载资源包\n        this.loadScene(\"gameHall\", \"login\");\n    }\n\n    public loadScene(abname: string, scenename: string): void {\n        let oldab = cc.assetManager.getBundle(abname);\n        if (oldab == null) {\n            cc.assetManager.loadBundle(abname, (err, bundle) => {\n                if (err) {\n                    console.error(abname + \" load fail.\");\n                    return;\n                }\n                console.log(\"loadSubpackage success name == \" + abname);\n                bundle.loadScene(scenename, (err, sceneAsset) => {\n                    if (err) {\n                        console.error(abname + \" load fail.\" + scenename);\n                        return;\n                    }\n                    console.log(sceneAsset + \" sceneName:\" + scenename);\n                    cc.director.runScene(sceneAsset);\n                });\n            });\n        }\n        else {\n            oldab.loadScene(scenename, (err, sceneAsset) => {\n                if (err) {\n                    console.error(abname + \" load fail.\" + scenename);\n                    return;\n                }\n                console.log(sceneAsset + \" sceneName:\" + scenename);\n                cc.director.runScene(sceneAsset);\n            });\n        }\n    }\n\n    //加载分包\n    public loadSubpackage(index: number) {\n        let self = this;\n        let name = self.loadSubpackageName[index];\n        cc.assetManager.loadBundle(name, (err, bundle) => {\n            if (err) {\n                return console.error(err);\n            }\n            console.log(\"loadSubpackage : \" + name + \" successfully.\");\n            if (index + 1 >= self.loadSubpackageName.length) {\n                //加载完成\n                self.loadSubpackageEnd();\n            } else {\n                self.loadSubpackage(index + 1);\n            }\n        });\n    }\n\n    //加载完成\n    public loadSubpackageEnd() {\n        this.redirectToLogin();\n    }\n\n    // 获取大厅版本信息\n    public getHallVersion() {\n        let list = BaseFrameNative.serverList.gamereslist;\n        for (let index = 0; index < list.length; index++) {\n            let data = list[index];\n            console.log(data);\n            if (data.id == 0) {\n                return data.version;\n            }\n        }\n        return null;\n    }\n\n    // 版本检查 比较方法versionA旧  versionB新\n    public versionCompareHandle(versionA: string, versionB: string): boolean {\n        if (versionA == null || versionB == null) return false;\n        let vA = versionA.split(\".\");\n        let vB = versionB.split(\".\");\n        for (let i = 0; i < vA.length; ++i) {\n            let a = parseInt(vA[i]);\n            let b = parseInt(vB[i]);\n            if (a === b) {\n                continue;\n            } else {\n                return b - a > 0;\n            }\n        }\n        if (vB.length > vA.length) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    // 判断是否需要强制更新大版本\n    public checkAppVersion(): boolean {\n        if (!BaseFrameNative.serverList) return false;\n        let nowVersion = \"\";\n        let oldVersion = MgrNative.getInstance().getAppVersion();\n        if (cc.sys.os == cc.sys.OS_ANDROID) {\n            nowVersion = BaseFrameNative.serverList.AppVersion;\n        } else if (cc.sys.os == cc.sys.OS_IOS) {\n            nowVersion = BaseFrameNative.serverList.IpaVersion;\n        }\n        console.log(\"nowVersion ==\", nowVersion);\n        console.log(\"oldVersion ==\", oldVersion);\n        this.newVersion = nowVersion;\n        let compareResult: boolean = this.versionCompareHandle(oldVersion, nowVersion);\n        return compareResult;\n    }\n}\n"]}