{"version":3,"sources":["assets\\GameHall\\script\\Lobby\\vip\\VipExidAdressView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { AudioManager } from \"../../../../Script/BaseFrame/AudioManager\";\r\nimport { CommonCtr } from \"../../../../Script/BaseFrame/CommonCtr\";\r\nimport ViewBase from \"../../../../Script/BaseFrame/ViewBase\";\r\nimport HttpHelpEx from \"../../../../Script/Common/Managers/HttpHelpEx\";\r\nimport { AppConst } from \"../../../../Script/modules/@slotsmaster/ui-common/lib/AppConst\";\r\nimport { BaseFrameNative } from \"../../../../Script/BaseFrameNative\";\r\nimport NativeMethod from \"../../NativeMethod\";\r\nimport LobbyViewCtr from \"../LobbyViewCtr\";\r\n\r\n/**\r\n * @description vip 编辑收获地址\r\n * \r\n */\r\nexport default class VipExidAdressView extends ViewBase {\r\n    protected get packageResourceName(): string {\r\n        return \"gameHall\";\r\n    }\r\n    protected get packageName(): string {\r\n        return \"res/Lobby\";\r\n    }\r\n    protected get componentName(): string {\r\n        return \"exidAdress\";\r\n    }\r\n\r\n    private ui_btn_addressBreak: fgui.GButton = null;\r\n    private ui_userName: fgui.GTextInput = null;\r\n    private ui_phone: fgui.GTextInput = null;\r\n    private ui_address: fgui.GTextInput = null;\r\n    private ui_saveInfo: fgui.GButton = null;\r\n\r\n    private ui_exidaddressImg: fgui.GLoader = null;\r\n\r\n    private ui_btn_address: fgui.GButton = null;\r\n    private ui_addresslabel: fgui.GTextField = null;\r\n    private oldLabel: string;\r\n\r\n    createChildComponents() {\r\n        super.createChildComponents();\r\n        this.fguiComponent.visible = false;\r\n        this.ui_btn_addressBreak.onClick(this.Hide, this);\r\n        this.ui_saveInfo.onClick(this.saveInfo, this);\r\n        NativeMethod.setUrlByLanguage(this.ui_exidaddressImg);\r\n\r\n        this.ui_btn_address.onClick(this.setFocus, this);\r\n        this.ui_address.node.opacity = 0;\r\n        this.ui_address.on(fgui.Event.TEXT_CHANGE, this.changedText, this);\r\n    }\r\n    OnLoadCompleted() {\r\n        this.oldLabel = this.ui_addresslabel.text;\r\n        this.Show();\r\n    }\r\n    public setFocus() {\r\n        this.ui_address.requestFocus();\r\n    }\r\n    public changedText() {\r\n        this.ui_addresslabel.text = this.ui_address.text;\r\n    }\r\n\r\n    public saveInfo() {\r\n        let userName = this.ui_userName.text;\r\n        let phone = this.ui_phone.text;\r\n        let address = this.ui_address.text;\r\n        if (!userName || !phone || !address) {\r\n            CommonCtr.instance.ShowTipLabel(\"请填写完整的信息\");\r\n            return;\r\n        }\r\n        let url = BaseFrameNative.serverlistItem.apiAdress + \"/api/Game/Additemorderaddress\";\r\n        let id = 0;\r\n        if (LobbyViewCtr.instance.view.vipShoppingView.addressInfo) {\r\n            id = LobbyViewCtr.instance.view.vipShoppingView.addressInfo.id;\r\n        }\r\n        let params = {\r\n            id: id,\r\n            UserId: AppConst.mPlayerModel.userid + '',\r\n            Address: `${userName}|${phone}|${address}`\r\n        }\r\n        fgui.GRoot.inst.showModalWait();\r\n        HttpHelpEx.instance.post(url, params, {\r\n            headers: {\r\n                \"Content-Type\": \"application/json; charset=utf-8\"\r\n            }\r\n        })\r\n            .then((res) => {\r\n                cc.log(\"---------设置----地址----\", res);\r\n                fgui.GRoot.inst.closeModalWait();\r\n                if (res.code == 1) {\r\n                    LobbyViewCtr.instance.view.vipShoppingView.address = params.Address;\r\n                    LobbyViewCtr.instance.Model.vipAddress = params.Address;\r\n                    this.Hide();\r\n                    CommonCtr.instance.ShowTipLabel(\"設置收貨地址成功\");\r\n                } else {\r\n                    CommonCtr.instance.ShowTipLabel(\"設置收貨地址失敗\");\r\n                }\r\n\r\n            })\r\n            .catch(() => {\r\n                fgui.GRoot.inst.closeModalWait();\r\n                CommonCtr.instance.ShowTipLabel(\"設置收貨地址失敗\");\r\n            })\r\n\r\n    }\r\n\r\n    Hide() {\r\n        AudioManager.Singleton.play('VipExidAdressView', \"button\");\r\n        super.Hide();\r\n    }\r\n\r\n    public Show() {\r\n        this.ui_addresslabel.text = this.oldLabel;\r\n        let address = LobbyViewCtr.instance.Model.vipAddress;\r\n        if (address != \"\") {\r\n            let list = address.split(\"|\");\r\n            if (list[0]) this.ui_userName.text = list[0];\r\n            if (list[1]) this.ui_phone.text = list[1];\r\n            if (list[2]) {\r\n                this.ui_address.text = list[2];\r\n                this.ui_addresslabel.text = list[2];\r\n            }\r\n        }\r\n        super.Show();\r\n    }\r\n\r\n\r\n}"]}