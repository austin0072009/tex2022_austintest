{"version":3,"sources":["assets\\GameHall\\script\\Lobby\\match\\MatchView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { AudioManager } from \"../../../../Script/BaseFrame/AudioManager\";\r\nimport ViewBase from \"../../../../Script/BaseFrame/ViewBase\";\r\nimport { UIUtil } from \"../../../../Script/Common/UIUtil\";\r\nimport { AppConst } from \"../../../../Script/modules/@slotsmaster/ui-common/lib/AppConst\";\r\nimport { CompeteInfo } from \"../LobbyNetData\";\r\nimport LobbyViewCtr from \"../LobbyViewCtr\";\r\nimport MatchItem from \"./MatchItem\";\r\n\r\n/**\r\n * @description 賽事\r\n */\r\nexport default class MatchView extends ViewBase {\r\n    protected get packageResourceName(): string {\r\n        return \"gameHall\";\r\n    }\r\n    protected get packageName(): string {\r\n        return \"res/Lobby\";\r\n    }\r\n    protected get componentName(): string {\r\n        return \"match\";\r\n    }\r\n\r\n    private ui_matchgold: fgui.GTextField = null;\r\n    private ui_matchList: fgui.GList = null;\r\n    private ui_btn_matchaddGold: fgui.GButton = null;\r\n    private ui_match_eyeBtn: fgui.GButton = null;\r\n\r\n    private ui_matchJackpot0: fgui.GTextField = null;\r\n    private ui_matchJackpot1: fgui.GTextField = null;\r\n    private ui_matchJackpot2: fgui.GTextField = null;\r\n    private ui_matchJackpot3: fgui.GTextField = null;\r\n    private ui_matchJackpot4: fgui.GTextField = null;\r\n    private ui_matchJackpot5: fgui.GTextField = null;\r\n    private ui_matchJackpot6: fgui.GTextField = null;\r\n    createChildComponents() {\r\n        super.createChildComponents();\r\n        this.fguiComponent.visible = false;\r\n        this.ui_btn_matchaddGold.onClick(this.showTopupView, this);\r\n        this.ui_match_eyeBtn.onClick(this.hideGold, this);\r\n        this.ui_matchList.setVirtual();\r\n        this.ui_matchList.itemRenderer = this.renderListItem.bind(this);\r\n        this.ui_matchList.on(fgui.Event.CLICK_ITEM, this.onClickItem, this);\r\n        this.setJackpot(0);\r\n    }\r\n\r\n    OnLoadCompleted() {\r\n        this.Show();\r\n    }\r\n\r\n    /**隐藏金币 */\r\n    public hideGold() {\r\n        AudioManager.Singleton.play('MatchView', \"button\");\r\n        if (this.ui_match_eyeBtn.selected) {\r\n            this.ui_matchgold.text = '*****';\r\n        } else {\r\n            this.ui_matchgold.text = UIUtil.formatNumber(AppConst.mPlayerModel.gold) + \"\";;\r\n        }\r\n    }\r\n\r\n    /**设置奖池 */\r\n    public setJackpot(jack: number) {\r\n        let temp = (jack + '').padStart(7, \"0\");\r\n        for (let i = 0; i < temp.length; i++) {\r\n            this[\"ui_matchJackpot\" + i].text = temp[i];\r\n        }\r\n    }\r\n\r\n    public renderListItem(index: number, obj: fgui.GObject) {\r\n        (<MatchItem>obj).setData(this.matchListData[index]);\r\n    }\r\n    /**赛事列表数据 */\r\n    public matchListData: CompeteInfo[] = [];\r\n\r\n    public handleMatchListData() {\r\n        this.matchListData = LobbyViewCtr.instance.Model.matchData;\r\n        this.ui_matchList.numItems = this.matchListData.length;\r\n\r\n\r\n\r\n        let all: number = 0;\r\n        /**获取奖池和 */\r\n        for (let i = 0; i < this.matchListData.length; i++) {\r\n            all += this.matchListData[i].prizepool;\r\n        }\r\n        this.jackpotNum = all;\r\n        if (this.jackpotNum2 == 0) {\r\n            this.jackpotNum2 = all;\r\n        }\r\n        if (all == 0) {\r\n            return;\r\n        }\r\n        this.rollJackpot();\r\n    }\r\n\r\n    /**当前选择的赛事 */\r\n    public selectItem: MatchItem;\r\n\r\n    /**点击赛事显示详情 */\r\n    public onClickItem(item: MatchItem) {\r\n        this.selectItem = item;\r\n        LobbyViewCtr.instance.view.showMatchDerailsView();\r\n    }\r\n\r\n    private timerId;\r\n    /**奖池值 */\r\n    private jackpotNum: number = 0;\r\n    private jackpotNum2: number = 0;\r\n    /**增加的次数 */\r\n    private addNum: number = 0;\r\n    public rollJackpot() {\r\n        clearTimeout(this.timerId);\r\n        this.timerId = setTimeout(() => {\r\n            let randomCont = Math.floor(Math.random() * 30 + 50);\r\n            if (this.addNum >= randomCont) {\r\n                //减少\r\n                this.addNum = 0;\r\n                let r = +(0.95 + (Math.random() * 7) / 100).toFixed(2);\r\n                this.jackpotNum = Math.floor(this.jackpotNum * r);\r\n                this.jackpotNum2 = this.jackpotNum;\r\n                this.setJackpot(this.jackpotNum);\r\n                this.rollJackpot();\r\n                return;\r\n            }\r\n            let randomN = Math.floor(Math.random() * 100 + 50);\r\n            this.jackpotNum2 += randomN;\r\n            this.setJackpot(this.jackpotNum2);\r\n            this.addNum++;\r\n            this.rollJackpot();\r\n\r\n        }, Math.floor(Math.random() * 3 + 1) * 1000)\r\n    }\r\n    /**显示充值 */\r\n    public showTopupView() {\r\n        AudioManager.Singleton.play('MatchView', \"button\");\r\n        LobbyViewCtr.instance.view.showTopup();\r\n    }\r\n    public Show() {\r\n        if (this.ui_match_eyeBtn.selected) {\r\n            this.ui_matchgold.text = '*****';\r\n        } else {\r\n            this.ui_matchgold.text = UIUtil.formatNumber(AppConst.mPlayerModel.gold) + \"\";;\r\n        }\r\n        LobbyViewCtr.instance.cs_compete_list();\r\n        super.Show();\r\n    }\r\n    public Hide() {\r\n        super.Hide();\r\n        clearTimeout(this.timerId);\r\n    }\r\n\r\n    public clean() {\r\n        clearTimeout(this.timerId);\r\n    }\r\n\r\n}"]}