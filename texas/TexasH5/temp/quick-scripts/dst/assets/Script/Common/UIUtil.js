
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/Common/UIUtil.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '6b5c6UVXQ1GWb8SVQX1ZpRM', 'UIUtil');
// Script/Common/UIUtil.ts

"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.PlayerPrefs = exports.UIUtil = void 0;
var BaseFrameNative_1 = require("../../Script/BaseFrameNative");
var CommonCtr_1 = require("../BaseFrame/CommonCtr");
var HttpHelpEx_1 = require("./Managers/HttpHelpEx");
var UIUtil = /** @class */ (function () {
    function UIUtil() {
    }
    UIUtil.formatNumber = function (_val) {
        return +(_val / 100).toFixed(2).slice(0, -1);
    };
    UIUtil.formatNumber100 = function (_val) {
        var strNum = (_val / 100).toString();
        0.06;
        var str = strNum.indexOf(".") >= 0 ? strNum.split(".")[1] : "";
        if (str.length != 0 && str.substring(0, 1) != "0") {
            return Number.parseFloat((_val / 100).toFixed(2).slice(0, -1));
        }
        else {
            return UIUtil.NumberToInt(_val / 100);
        }
    };
    UIUtil.formatNumber100ToK = function (val) {
        var _val = UIUtil.formatNumber100(val);
        if (_val < 1000) {
            return _val + "";
        }
        var strNum = (_val / 1000).toString();
        var str = strNum.indexOf(".") >= 0 ? strNum.split(".")[1] : "";
        var num = 0;
        if (str.length != 0 && str.substring(0, 1) != "0") {
            return Number.parseFloat((_val / 1000).toFixed(2).slice(0, -1)) + "K";
        }
        else {
            return UIUtil.NumberToInt(_val / 1000) + "K";
        }
    };
    UIUtil.isNumber = function (text) {
        var n = Number(text);
        if (!isNaN(n)) {
            return true;
        }
        else {
            return false;
        }
    };
    // 加载图片
    UIUtil.loadImage = function (loader, resNameorurl, packageName) {
        var httptype = false;
        var httpHead = false;
        if (resNameorurl.startsWith("http"))
            httptype = true;
        if (resNameorurl.indexOf("fordlc/wechat") != -1) {
            httpHead = true;
            resNameorurl = BaseFrameNative_1.BaseFrameNative.serverlistItem.apiAdress + resNameorurl;
        }
        if (httptype || httpHead) {
            loader.url = resNameorurl;
        }
        else {
            var res_url = fgui.UIPackage.getItemURL(packageName, resNameorurl);
            loader.url = res_url;
        }
    };
    // 加载商城图片
    UIUtil.loadShopImage = function (loader, resNameorurl, packageName) {
        var httptype = false;
        var httpHead = false;
        if (resNameorurl.startsWith("http"))
            httptype = true;
        if (resNameorurl.indexOf("fordlc/wechat") != -1) {
            httpHead = true;
            resNameorurl = BaseFrameNative_1.BaseFrameNative.serverlistItem.api2 + resNameorurl;
        }
        if (httptype || httpHead) {
            loader.url = resNameorurl;
        }
        else {
            var res_url = fgui.UIPackage.getItemURL(packageName, resNameorurl);
            loader.url = res_url;
        }
    };
    // 添加搜索路径
    UIUtil.addSearchPaths = function (path) {
        var pathList = jsb.fileUtils.getSearchPaths();
        for (var index = 0; index < pathList.length; index++) {
            var tempPath = pathList[index];
            if (tempPath == path) {
                return;
            }
        }
        // 没有加到搜索路径
        pathList.unshift(path);
        jsb.fileUtils.setSearchPaths(pathList);
    };
    /// <summary>
    /// Image 变灰开关
    /// </summary>
    /// <param name="target"></param>
    /// <param name="flag"></param>
    UIUtil.ImageGreyToggle = function (target, flag) {
        if (target == null)
            return;
        target.grayed = flag;
    };
    //影藏节点下的子节点
    UIUtil.HideChildren = function (com, isShow) {
        if (isShow === void 0) { isShow = false; }
        if (com == null)
            return;
        for (var i = 0; i < com._children.length; i++) {
            com._children[i].visible = isShow;
        }
    };
    //文本长度限制
    UIUtil.SetLimitTxt = function (txt, content, length) {
        if (length === void 0) { length = 6; }
        if (txt != null) {
            txt.text = this.getNickNameSub(content, length);
        }
    };
    UIUtil.getNickNameSub = function (str, _length) {
        if (this.strLength(str) <= _length) {
            return str;
        }
        var resStr = "";
        var cnt = 0;
        for (var i = 0; i < str.length; i++) {
            if (str.charCodeAt(i) > 255) {
                cnt += 2;
            }
            else {
                cnt++;
            }
            resStr += str.substring(i, i + 1);
            if (cnt >= _length)
                break;
        }
        return resStr;
    };
    UIUtil.strLength = function (str) {
        var cnt = 0;
        for (var i = 0; i < str.length; i++) {
            if (str.charCodeAt(i) > 255)
                cnt += 2;
            else
                cnt++;
        }
        return cnt;
    };
    /// <summary>
    /// 根据秒数获取00：00格式的string
    /// </summary>
    /// <param name="seconds"></param>
    /// <returns></returns>
    UIUtil.getStringTime = function (seconds) {
        var hou = UIUtil.NumberToInt(seconds / (60 * 60 * 24));
        var min = UIUtil.NumberToInt((seconds % (60 * 60 * 24)) / 60);
        var strresult = "";
        var sec = UIUtil.NumberToInt(seconds % 60);
        if (hou > 0) {
            if (hou < 10) {
                strresult = strresult + "0" + hou + ":";
            }
            else {
                strresult = strresult + "" + hou + ":";
            }
        }
        if (min > 0) {
            if (min < 10) {
                strresult = strresult + "0" + min + ":";
            }
            else {
                strresult = strresult + "" + min + ":";
            }
        }
        else {
            strresult = strresult + "00:";
        }
        if (sec > 0) {
            if (sec < 10) {
                strresult = strresult + "0" + sec;
            }
            else {
                strresult = strresult + "" + sec;
            }
        }
        else {
            strresult = strresult + "00";
        }
        return strresult;
    };
    //数组拼接
    UIUtil.Concat = function (arr1, arr2) {
        if (arr1 == null)
            arr1 = [];
        if (arr2 == null)
            arr2 = [];
        arr2.forEach(function (element) {
            arr1.push(element);
        });
        return arr1;
    };
    /**验证字符串是否为数字 */
    UIUtil.checkNumber = function (value) {
        var reg = /^[0-9]+.?[0-9]*$/;
        if (reg.test(value)) {
            return true;
        }
        return false;
    };
    //文字渐变,优先使用value
    UIUtil.TextGradient = function (topColor, bottomColor, value, textField) {
        if (value === void 0) { value = ""; }
        var str = "";
        if (textField != null) {
            textField.ubbEnabled = true;
            str = textField.text;
        }
        str = value == null || value == "" ? str : value;
        var strColor = "[color=" + topColor + "," + bottomColor + "]" + str + "[/color]";
        if (textField)
            textField.text = strColor;
        return strColor;
    };
    //小数转整形,Math.floot会进一位
    UIUtil.NumberToInt = function (num) {
        var strNum = num.toString();
        return Number.parseInt(strNum);
    };
    // 客服功能
    UIUtil.kefuFunction = function (callBack) {
        var url = BaseFrameNative_1.BaseFrameNative.serverlistItem.apiAdress + "/api/Game/GetLogolist";
        var params = {};
        HttpHelpEx_1.default.instance.post(url, params)
            .then(function (res) {
            console.log("---GetLogolist---", res);
            if (res.code == 1) {
                // cc.sys.openURL(res.curl);
                callBack(res.curl);
            }
            else {
                CommonCtr_1.CommonCtr.instance.view.ShowTipLabel("获取客服信息失败");
            }
        }).catch(function (err) {
            console.log("---err---", err);
            CommonCtr_1.CommonCtr.instance.view.ShowTipLabel("获取客服信息失败");
        });
    };
    //富文本才能显示表情图片  imgUrl：ui://包名/图片
    UIUtil.prototype.EmojiToHtml = function (imgUrl, height, width) {
        if (height === void 0) { height = 50; }
        if (width === void 0) { width = 50; }
        return "<img src=\"" + imgUrl + "\" height=\"" + height + "\" width=\"" + width + "\"></img>";
    };
    return UIUtil;
}());
exports.UIUtil = UIUtil;
var PlayerPrefs = /** @class */ (function () {
    function PlayerPrefs() {
    }
    PlayerPrefs.SetInt = function (key, value) {
        cc.sys.localStorage.setItem(key, value);
    };
    PlayerPrefs.SetString = function (key, value) {
        cc.sys.localStorage.setItem(key, value);
    };
    PlayerPrefs.GetInt = function (key, value) {
        var _val = cc.sys.localStorage.getItem(key);
        if (_val != null) {
            return Number.parseInt(_val);
        }
        else {
            this.SetInt(key, value);
            return value;
        }
    };
    PlayerPrefs.GetString = function (key, value) {
        var _val = cc.sys.localStorage.getItem(key);
        if (_val != null && _val != "") {
            return _val;
        }
        else {
            this.SetString(key, value);
            return value;
        }
    };
    return PlayerPrefs;
}());
exports.PlayerPrefs = PlayerPrefs;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxDb21tb25cXFVJVXRpbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxnRUFBK0Q7QUFDL0Qsb0RBQW1EO0FBQ25ELG9EQUErQztBQUUvQztJQUFBO0lBMlBBLENBQUM7SUExUGlCLG1CQUFZLEdBQTFCLFVBQTJCLElBQVk7UUFDbkMsT0FBTyxDQUFDLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDakQsQ0FBQztJQUdhLHNCQUFlLEdBQTdCLFVBQThCLElBQVk7UUFDdEMsSUFBSSxNQUFNLEdBQUcsQ0FBQyxJQUFJLEdBQUcsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7UUFBQyxJQUFJLENBQUE7UUFDMUMsSUFBSSxHQUFHLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztRQUMvRCxJQUFJLEdBQUcsQ0FBQyxNQUFNLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLEdBQUcsRUFBRTtZQUMvQyxPQUFPLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLEdBQUcsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ2xFO2FBQU07WUFDSCxPQUFPLE1BQU0sQ0FBQyxXQUFXLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQyxDQUFDO1NBQ3pDO0lBQ0wsQ0FBQztJQUVhLHlCQUFrQixHQUFoQyxVQUFp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R0FBRyxDQUFDLENBQUM7UUFDcEQsSUFBSSxJQUFJLElBQUksSUFBSSxFQUFFO1lBQ2QsT0FBTyxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ2hDO2FBQU07WUFDSCxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUN4QixPQUFPLEtBQUssQ0FBQztTQUNoQjtJQUNMLENBQUM7SUFFYSxxQkFBUyxHQUF2QixVQUF3QixHQUFXLEVBQUUsS0FBYTtRQUM5QyxJQUFJLElBQUksR0FBVyxFQUFFLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDcEQsSUFBSSxJQUFJLElBQUksSUFBSSxJQUFJLElBQUksSUFBSSxFQUFFLEVBQUU7WUFDNUIsT0FBTyxJQUFJLENBQUM7U0FDZjthQUFNO1lBQ0gsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDM0IsT0FBTyxLQUFLLENBQUM7U0FDaEI7SUFDTCxDQUFDO0lBQ0wsa0JBQUM7QUFBRCxDQTVCQSxBQTRCQyxJQUFBO0FBNUJZLGtDQUFXIiwiZmlsZSI6IiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQmFzZUZyYW1lTmF0aXZlIH0gZnJvbSBcIi4uLy4uL1NjcmlwdC9CYXNlRnJhbWVOYXRpdmVcIjtcbmltcG9ydCB7IENvbW1vbkN0ciB9IGZyb20gXCIuLi9CYXNlRnJhbWUvQ29tbW9uQ3RyXCI7XG5pbXBvcnQgSHR0cEhlbHBFeCBmcm9tIFwiLi9NYW5hZ2Vycy9IdHRwSGVscEV4XCI7XG5cbmV4cG9ydCBjbGFzcyBVSVV0aWwge1xuICAgIHB1YmxpYyBzdGF0aWMgZm9ybWF0TnVtYmVyKF92YWw6IG51bWJlcik6IG51bWJlciB7XG4gICAgICAgIHJldHVybiArKF92YWwgLyAxMDApLnRvRml4ZWQoMikuc2xpY2UoMCwgLTEpO1xuICAgIH1cblxuXG4gICAgcHVibGljIHN0YXRpYyBmb3JtYXROdW1iZXIxMDAoX3ZhbDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAgICAgbGV0IHN0ck51bSA9IChfdmFsIC8gMTAwKS50b1N0cmluZygpOyAwLjA2XG4gICAgICAgIGxldCBzdHIgPSBzdHJOdW0uaW5kZXhPZihcIi5cIikgPj0gMCA/IHN0ck51bS5zcGxpdChcIi5cIilbMV0gOiBcIlwiO1xuICAgICAgICBpZiAoc3RyLmxlbmd0aCAhPSAwICYmIHN0ci5zdWJzdHJpbmcoMCwgMSkgIT0gXCIwXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBOdW1iZXIucGFyc2VGbG9hdCgoX3ZhbCAvIDEwMCkudG9GaXhlZCgyKS5zbGljZSgwLCAtMSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFVJVXRpbC5OdW1iZXJUb0ludChfdmFsIC8gMTAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgZm9ybWF0TnVtYmVyMTAwVG9LKHZhbDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IF92YWwgPSBVSVV0aWwuZm9ybWF0TnVtYmVyMTAwKHZhbCk7XG4gICAgICAgIGlmIChfdmFsIDwgMTAwMCkge1xuICAgICAgICAgICAgcmV0dXJuIF92YWwgKyBcIlwiO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHN0ck51bSA9IChfdmFsIC8gMTAwMCkudG9TdHJpbmcoKTtcbiAgICAgICAgbGV0IHN0ciA9IHN0ck51bS5pbmRleE9mKFwiLlwiKSA+PSAwID8gc3RyTnVtLnNwbGl0KFwiLlwiKVsxXSA6IFwiXCI7XG4gICAgICAgIGxldCBudW0gPSAwO1xuICAgICAgICBpZiAoc3RyLmxlbmd0aCAhPSAwICYmIHN0ci5zdWJzdHJpbmcoMCwgMSkgIT0gXCIwXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBOdW1iZXIucGFyc2VGbG9hdCgoX3ZhbCAvIDEwMDApLnRvRml4ZWQoMikuc2xpY2UoMCwgLTEpKSArIFwiS1wiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFVJVXRpbC5OdW1iZXJUb0ludChfdmFsIC8gMTAwMCkgKyBcIktcIjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgaXNOdW1iZXIodGV4dDogc3RyaW5nKSB7XG4gICAgICAgIGxldCBuID0gTnVtYmVyKHRleHQpO1xuICAgICAgICBpZiAoIWlzTmFOKG4pKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIOWKoOi9veWbvueJh1xuICAgIHB1YmxpYyBzdGF0aWMgbG9hZEltYWdlKGxvYWRlcjogZmd1aS5HTG9hZGVyLCByZXNOYW1lb3J1cmw6IHN0cmluZywgcGFja2FnZU5hbWU/OiBzdHJpbmcpIHtcbiAgICAgICAgbGV0IGh0dHB0eXBlOiBib29sZWFuID0gZmFsc2U7XG4gICAgICAgIGxldCBodHRwSGVhZDogYm9vbGVhbiA9IGZhbHNlO1xuICAgICAgICBpZiAocmVzTmFtZW9ydXJsLnN0YXJ0c1dpdGgoXCJodHRwXCIpKSBodHRwdHlwZSA9IHRydWU7XG4gICAgICAgIGlmIChyZXNOYW1lb3J1cmwuaW5kZXhPZihcImZvcmRsYy93ZWNoYXRcIikgIT0gLTEpIHtcbiAgICAgICAgICAgIGh0dHBIZWFkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJlc05hbWVvcnVybCA9IEJhc2VGcmFtZU5hdGl2ZS5zZXJ2ZXJsaXN0SXRlbS5hcGlBZHJlc3MgKyByZXNOYW1lb3J1cmw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaHR0cHR5cGUgfHwgaHR0cEhlYWQpIHtcbiAgICAgICAgICAgIGxvYWRlci51cmwgPSByZXNOYW1lb3J1cmw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgcmVzX3VybCA9IGZndWkuVUlQYWNrYWdlLmdldEl0ZW1VUkwocGFja2FnZU5hbWUsIHJlc05hbWVvcnVybCk7XG4gICAgICAgICAgICBsb2FkZXIudXJsID0gcmVzX3VybDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIOWKoOi9veWVhuWfjuWbvueJh1xuICAgIHB1YmxpYyBzdGF0aWMgbG9hZFNob3BJbWFnZShsb2FkZXI6IGZndWkuR0xvYWRlciwgcmVzTmFtZW9ydXJsOiBzdHJpbmcsIHBhY2thZ2VOYW1lPzogc3RyaW5nKSB7XG4gICAgICAgIGxldCBodHRwdHlwZTogYm9vbGVhbiA9IGZhbHNlO1xuICAgICAgICBsZXQgaHR0cEhlYWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICAgICAgaWYgKHJlc05hbWVvcnVybC5zdGFydHNXaXRoKFwiaHR0cFwiKSkgaHR0cHR5cGUgPSB0cnVlO1xuICAgICAgICBpZiAocmVzTmFtZW9ydXJsLmluZGV4T2YoXCJmb3JkbGMvd2VjaGF0XCIpICE9IC0xKSB7XG4gICAgICAgICAgICBodHRwSGVhZCA9IHRydWU7XG4gICAgICAgICAgICByZXNOYW1lb3J1cmwgPSBCYXNlRnJhbWVOYXRpdmUuc2VydmVybGlzdEl0ZW0uYXBpMiArIHJlc05hbWVvcnVybDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaHR0cHR5cGUgfHwgaHR0cEhlYWQpIHtcbiAgICAgICAgICAgIGxvYWRlci51cmwgPSByZXNOYW1lb3J1cmw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgcmVzX3VybCA9IGZndWkuVUlQYWNrYWdlLmdldEl0ZW1VUkwocGFja2FnZU5hbWUsIHJlc05hbWVvcnVybCk7XG4gICAgICAgICAgICBsb2FkZXIudXJsID0gcmVzX3VybDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIOa3u+WKoOaQnOe0oui3r+W+hFxuICAgIHB1YmxpYyBzdGF0aWMgYWRkU2VhcmNoUGF0aHMocGF0aDogc3RyaW5nKSB7XG4gICAgICAgIGxldCBwYXRoTGlzdCA9IGpzYi5maWxlVXRpbHMuZ2V0U2VhcmNoUGF0aHMoKTtcbiAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHBhdGhMaXN0Lmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgbGV0IHRlbXBQYXRoID0gcGF0aExpc3RbaW5kZXhdO1xuICAgICAgICAgICAgaWYgKHRlbXBQYXRoID09IHBhdGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8g5rKh5pyJ5Yqg5Yiw5pCc57Si6Lev5b6EXG4gICAgICAgIHBhdGhMaXN0LnVuc2hpZnQocGF0aCk7XG4gICAgICAgIGpzYi5maWxlVXRpbHMuc2V0U2VhcmNoUGF0aHMocGF0aExpc3QpO1xuICAgIH1cblxuICAgIC8vLyA8c3VtbWFyeT5cbiAgICAvLy8gSW1hZ2Ug5Y+Y54Gw5byA5YWzXG4gICAgLy8vIDwvc3VtbWFyeT5cbiAgICAvLy8gPHBhcmFtIG5hbWU9XCJ0YXJnZXRcIj48L3BhcmFtPlxuICAgIC8vLyA8cGFyYW0gbmFtZT1cImZsYWdcIj48L3BhcmFtPlxuICAgIHB1YmxpYyBzdGF0aWMgSW1hZ2VHcmV5VG9nZ2xlKHRhcmdldDogZmd1aS5HT2JqZWN0LCBmbGFnOiBib29sZWFuKSB7XG4gICAgICAgIGlmICh0YXJnZXQgPT0gbnVsbCkgcmV0dXJuO1xuICAgICAgICB0YXJnZXQuZ3JheWVkID0gZmxhZ1xuICAgIH1cblxuICAgIC8v5b2x6JeP6IqC54K55LiL55qE5a2Q6IqC54K5XG4gICAgcHVibGljIHN0YXRpYyBIaWRlQ2hpbGRyZW4oY29tOiBmZ3VpLkdDb21wb25lbnQsIGlzU2hvdzogYm9vbGVhbiA9IGZhbHNlKSB7XG4gICAgICAgIGlmIChjb20gPT0gbnVsbCkgcmV0dXJuO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbS5fY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbS5fY2hpbGRyZW5baV0udmlzaWJsZSA9IGlzU2hvdztcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgLy/mlofmnKzplb/luqbpmZDliLZcbiAgICBwdWJsaWMgc3RhdGljIFNldExpbWl0VHh0KHR4dDogZmd1aS5HVGV4dEZpZWxkLCBjb250ZW50OiBzdHJpbmcsIGxlbmd0aDogbnVtYmVyID0gNikge1xuICAgICAgICBpZiAodHh0ICE9IG51bGwpIHtcbiAgICAgICAgICAgIHR4dC50ZXh0ID0gdGhpcy5nZXROaWNrTmFtZVN1Yihjb250ZW50LCBsZW5ndGgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0Tmlja05hbWVTdWIoc3RyOiBzdHJpbmcsIF9sZW5ndGg6IG51bWJlcik6IHN0cmluZyB7XG4gICAgICAgIGlmICh0aGlzLnN0ckxlbmd0aChzdHIpIDw9IF9sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBzdHI7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgcmVzU3RyID0gXCJcIjtcbiAgICAgICAgbGV0IGNudCA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoc3RyLmNoYXJDb2RlQXQoaSkgPiAyNTUpIHtcbiAgICAgICAgICAgICAgICBjbnQgKz0gMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNudCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzU3RyICs9IHN0ci5zdWJzdHJpbmcoaSwgaSArIDEpO1xuXG4gICAgICAgICAgICBpZiAoY250ID49IF9sZW5ndGgpIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXNTdHI7XG4gICAgfVxuICAgIHB1YmxpYyBzdGF0aWMgc3RyTGVuZ3RoKHN0cikge1xuICAgICAgICB2YXIgY250ID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChzdHIuY2hhckNvZGVBdChpKSA+IDI1NSlcbiAgICAgICAgICAgICAgICBjbnQgKz0gMjtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBjbnQrKztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY250O1xuICAgIH1cblxuXG4gICAgLy8vIDxzdW1tYXJ5PlxuICAgIC8vLyDmoLnmja7np5LmlbDojrflj5YwMO+8mjAw5qC85byP55qEc3RyaW5nXG4gICAgLy8vIDwvc3VtbWFyeT5cbiAgICAvLy8gPHBhcmFtIG5hbWU9XCJzZWNvbmRzXCI+PC9wYXJhbT5cbiAgICAvLy8gPHJldHVybnM+PC9yZXR1cm5zPlxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0U3RyaW5nVGltZShzZWNvbmRzOiBudW1iZXIpOiBzdHJpbmcge1xuICAgICAgICBsZXQgaG91ID0gVUlVdGlsLk51bWJlclRvSW50KHNlY29uZHMgLyAoNjAgKiA2MCAqIDI0KSk7XG4gICAgICAgIGxldCBtaW4gPSBVSVV0aWwuTnVtYmVyVG9JbnQoKHNlY29uZHMgJSAoNjAgKiA2MCAqIDI0KSkgLyA2MCk7XG4gICAgICAgIGxldCBzdHJyZXN1bHQgPSBcIlwiO1xuICAgICAgICBsZXQgc2VjID0gVUlVdGlsLk51bWJlclRvSW50KHNlY29uZHMgJSA2MCk7XG4gICAgICAgIGlmIChob3UgPiAwKSB7XG4gICAgICAgICAgICBpZiAoaG91IDwgMTApIHtcbiAgICAgICAgICAgICAgICBzdHJyZXN1bHQgPSBzdHJyZXN1bHQgKyBcIjBcIiArIGhvdSArIFwiOlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RycmVzdWx0ID0gc3RycmVzdWx0ICsgXCJcIiArIGhvdSArIFwiOlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChtaW4gPiAwKSB7XG4gICAgICAgICAgICBpZiAobWluIDwgMTApIHtcbiAgICAgICAgICAgICAgICBzdHJyZXN1bHQgPSBzdHJyZXN1bHQgKyBcIjBcIiArIG1pbiArIFwiOlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RycmVzdWx0ID0gc3RycmVzdWx0ICsgXCJcIiArIG1pbiArIFwiOlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3RycmVzdWx0ID0gc3RycmVzdWx0ICsgXCIwMDpcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VjID4gMCkge1xuICAgICAgICAgICAgaWYgKHNlYyA8IDEwKSB7XG4gICAgICAgICAgICAgICAgc3RycmVzdWx0ID0gc3RycmVzdWx0ICsgXCIwXCIgKyBzZWM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdHJyZXN1bHQgPSBzdHJyZXN1bHQgKyBcIlwiICsgc2VjO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3RycmVzdWx0ID0gc3RycmVzdWx0ICsgXCIwMFwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdHJyZXN1bHQ7XG4gICAgfVxuXG4gICAgLy/mlbDnu4Tmi7zmjqVcbiAgICBwdWJsaWMgc3RhdGljIENvbmNhdDxUPihhcnIxOiBUW10sIGFycjI6IFRbXSk6IFRbXSB7XG4gICAgICAgIGlmIChhcnIxID09IG51bGwpIGFycjEgPSBbXTtcbiAgICAgICAgaWYgKGFycjIgPT0gbnVsbCkgYXJyMiA9IFtdO1xuICAgICAgICBhcnIyLmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICAgICAgICBhcnIxLnB1c2goZWxlbWVudCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYXJyMTtcbiAgICB9XG5cbiAgICAvKirpqozor4HlrZfnrKbkuLLmmK/lkKbkuLrmlbDlrZcgKi9cbiAgICBwdWJsaWMgc3RhdGljIGNoZWNrTnVtYmVyKHZhbHVlOiBhbnkpIHtcbiAgICAgICAgbGV0IHJlZyA9IC9eWzAtOV0rLj9bMC05XSokLztcbiAgICAgICAgaWYgKHJlZy50ZXN0KHZhbHVlKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8v5paH5a2X5riQ5Y+YLOS8mOWFiOS9v+eUqHZhbHVlXG4gICAgcHVibGljIHN0YXRpYyBUZXh0R3JhZGllbnQodG9wQ29sb3I6IHN0cmluZywgYm90dG9tQ29sb3I6IHN0cmluZywgdmFsdWU6IHN0cmluZyA9IFwiXCIsIHRleHRGaWVsZD86IGZndWkuR1RleHRGaWVsZCk6IHN0cmluZyB7XG4gICAgICAgIGxldCBzdHIgPSBcIlwiO1xuICAgICAgICBpZiAodGV4dEZpZWxkICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRleHRGaWVsZC51YmJFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHN0ciA9IHRleHRGaWVsZC50ZXh0O1xuICAgICAgICB9XG4gICAgICAgIHN0ciA9IHZhbHVlID09IG51bGwgfHwgdmFsdWUgPT0gXCJcIiA/IHN0ciA6IHZhbHVlO1xuICAgICAgICBsZXQgc3RyQ29sb3IgPSBcIltjb2xvcj1cIiArIHRvcENvbG9yICsgXCIsXCIgKyBib3R0b21Db2xvciArIFwiXVwiICsgc3RyICsgXCJbL2NvbG9yXVwiO1xuICAgICAgICBpZiAodGV4dEZpZWxkKSB0ZXh0RmllbGQudGV4dCA9IHN0ckNvbG9yO1xuICAgICAgICByZXR1cm4gc3RyQ29sb3I7XG4gICAgfVxuXG4gICAgLy/lsI/mlbDovazmlbTlvaIsTWF0aC5mbG9vdOS8mui/m+S4gOS9jVxuICAgIHB1YmxpYyBzdGF0aWMgTnVtYmVyVG9JbnQobnVtOiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICBsZXQgc3RyTnVtOiBzdHJpbmcgPSBudW0udG9TdHJpbmcoKTtcbiAgICAgICAgcmV0dXJuIE51bWJlci5wYXJzZUludChzdHJOdW0pO1xuICAgIH1cblxuICAgIC8vIOWuouacjeWKn+iDvVxuICAgIHB1YmxpYyBzdGF0aWMga2VmdUZ1bmN0aW9uKGNhbGxCYWNrOiBGdW5jdGlvbikge1xuICAgICAgICBsZXQgdXJsID0gQmFzZUZyYW1lTmF0aXZlLnNlcnZlcmxpc3RJdGVtLmFwaUFkcmVzcyArIFwiL2FwaS9HYW1lL0dldExvZ29saXN0XCI7XG4gICAgICAgIGxldCBwYXJhbXMgPSB7fVxuICAgICAgICBIdHRwSGVscEV4Lmluc3RhbmNlLnBvc3QodXJsLCBwYXJhbXMpXG4gICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCItLS1HZXRMb2dvbGlzdC0tLVwiLCByZXMpO1xuICAgICAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNjLnN5cy5vcGVuVVJMKHJlcy5jdXJsKTtcbiAgICAgICAgICAgICAgICAgICAgY2FsbEJhY2socmVzLmN1cmwpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIENvbW1vbkN0ci5pbnN0YW5jZS52aWV3LlNob3dUaXBMYWJlbChcIuiOt+WPluWuouacjeS/oeaBr+Wksei0pVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCItLS1lcnItLS1cIiwgZXJyKVxuICAgICAgICAgICAgICAgIENvbW1vbkN0ci5pbnN0YW5jZS52aWV3LlNob3dUaXBMYWJlbChcIuiOt+WPluWuouacjeS/oeaBr+Wksei0pVwiKTtcbiAgICAgICAgICAgIH0pXG4gICAgfVxuXG4gICAgLy/lr4zmlofmnKzmiY3og73mmL7npLrooajmg4Xlm77niYcgIGltZ1VybO+8mnVpOi8v5YyF5ZCNL+WbvueJh1xuICAgIHB1YmxpYyBFbW9qaVRvSHRtbChpbWdVcmw6IHN0cmluZywgaGVpZ2h0OiBudW1iZXIgPSA1MCwgd2lkdGg6IG51bWJlciA9IDUwKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGA8aW1nIHNyYz1cIiR7aW1nVXJsfVwiIGhlaWdodD1cIiR7aGVpZ2h0fVwiIHdpZHRoPVwiJHt3aWR0aH1cIj48L2ltZz5gXG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgUGxheWVyUHJlZnMge1xuICAgIHB1YmxpYyBzdGF0aWMgU2V0SW50KGtleTogc3RyaW5nLCB2YWx1ZTogbnVtYmVyKSB7XG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIHZhbHVlKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIFNldFN0cmluZyhrZXk6IHN0cmluZywgdmFsdWU6IHN0cmluZykge1xuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCB2YWx1ZSk7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBHZXRJbnQoa2V5OiBzdHJpbmcsIHZhbHVlOiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICBsZXQgX3ZhbDogc3RyaW5nID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSk7XG4gICAgICAgIGlmIChfdmFsICE9IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiBOdW1iZXIucGFyc2VJbnQoX3ZhbCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLlNldEludChrZXksIHZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgR2V0U3RyaW5nKGtleTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IF92YWw6IHN0cmluZyA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgICAgICBpZiAoX3ZhbCAhPSBudWxsICYmIF92YWwgIT0gXCJcIikge1xuICAgICAgICAgICAgcmV0dXJuIF92YWw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLlNldFN0cmluZyhrZXksIHZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbn0iXX0=